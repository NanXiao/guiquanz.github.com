<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>core/nginx.c - src</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
  <h3>core/nginx.c - src</h3>
   <a href="../index.html"> Table of Contents </a>
 <h4>Global variables defined</h4>
 <ul>
<li><a href="#L193">ngx_conf_file</a></li>
<li><a href="#L194">ngx_conf_params</a></li>
<li><a href="#L35">ngx_core_commands</a></li>
<li><a href="#L171">ngx_core_module</a></li>
<li><a href="#L164">ngx_core_module_ctx</a></li>
<li><a href="#L28">ngx_debug_points</a></li>
<li><a href="#L187">ngx_max_module</a></li>
<li><a href="#L198">ngx_os_environ</a></li>
<li><a href="#L192">ngx_prefix</a></li>
<li><a href="#L191">ngx_show_configure</a></li>
<li><a href="#L189">ngx_show_help</a></li>
<li><a href="#L190">ngx_show_version</a></li>
<li><a href="#L195">ngx_signal</a></li>
</ul>
 <h4>Functions defined</h4>
 <ul>
<li><a href="#L202">main</a></li>
<li><a href="#L415">ngx_add_inherited_sockets</a></li>
<li><a href="#L929">ngx_core_module_create_conf</a></li>
<li><a href="#L978">ngx_core_module_init_conf</a></li>
<li><a href="#L567">ngx_exec_new_binary</a></li>
<li><a href="#L1318">ngx_get_cpu_affinity</a></li>
<li><a href="#L668">ngx_get_options</a></li>
<li><a href="#L833">ngx_process_options</a></li>
<li><a href="#L791">ngx_save_argv</a></li>
<li><a href="#L1246">ngx_set_cpu_affinity</a></li>
<li><a href="#L1176">ngx_set_env</a></li>
<li><a href="#L468">ngx_set_environment</a></li>
<li><a href="#L1206">ngx_set_priority</a></li>
<li><a href="#L1113">ngx_set_user</a></li>
<li><a href="#L1338">ngx_set_worker_processes</a></li>
</ul>
 <h4>Source code</h4>

  <code><ol><li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Copyright (C) Igor Sysoev<br/></li>
<li></span><span class="Comment"> * Copyright (C) Nginx, Inc.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;ngx_config.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;ngx_core.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;<a href="../http/modules/perl/ngx_http_perl_module.h.html#L21" title="http/modules/perl/ngx_http_perl_module.h:21">nginx</a>.h&gt;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="#L415" title="core/nginx.c:415">ngx_add_inherited_sockets</a>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle);<br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="#L668" title="core/nginx.c:668">ngx_get_options</a>(<span class="Type">int</span> argc, <span class="Type">char</span> *<span class="Type">const</span> *argv);<br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="#L833" title="core/nginx.c:833">ngx_process_options</a>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle);<br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="#L791" title="core/nginx.c:791">ngx_save_argv</a>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle, <span class="Type">int</span> argc, <span class="Type">char</span> *<span class="Type">const</span> *argv);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> *<a href="#L929" title="core/nginx.c:929">ngx_core_module_create_conf</a>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle);<br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<a href="#L978" title="core/nginx.c:978">ngx_core_module_init_conf</a>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle, <span class="Type">void</span> *conf);<br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<a href="#L1113" title="core/nginx.c:1113">ngx_set_user</a>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf);<br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<a href="#L1176" title="core/nginx.c:1176">ngx_set_env</a>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf);<br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<a href="#L1206" title="core/nginx.c:1206">ngx_set_priority</a>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf);<br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<a href="#L1246" title="core/nginx.c:1246">ngx_set_cpu_affinity</a>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd,<br/></li>
<li>&nbsp; &nbsp; <span class="Type">void</span> *conf);<br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<a href="#L1338" title="core/nginx.c:1338">ngx_set_worker_processes</a>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd,<br/></li>
<li>&nbsp; &nbsp; <span class="Type">void</span> *conf);<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L28">&#x200c;</a><span class="Type">static</span> <a href="ngx_conf_file.h.html#L201" title="core/ngx_conf_file.h:201">ngx_conf_enum_t</a>&nbsp; <span class="linkable">ngx_debug_points</span>[] = {<br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;stop&quot;</span>), <a href="ngx_cycle.h.html#L21" title="core/ngx_cycle.h:21">NGX_DEBUG_POINTS_STOP</a> },<br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;abort&quot;</span>), <a href="ngx_cycle.h.html#L22" title="core/ngx_cycle.h:22">NGX_DEBUG_POINTS_ABORT</a> },<br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L41" title="core/ngx_string.h:41">ngx_null_string</a>, <span class="Constant">0</span> }<br/></li>
<li>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L35">&#x200c;</a><span class="Type">static</span> <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a>&nbsp; <span class="linkable">ngx_core_commands</span>[] = {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;daemon&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L44" title="core/ngx_conf_file.h:44">NGX_CONF_FLAG</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L943" title="core/ngx_conf_file.c:943">ngx_conf_set_flag_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, daemon),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;<a href="../os/unix/ngx_process_cycle.c.html#L65" title="os/unix/ngx_process_cycle.c:65">master_process</a>&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L44" title="core/ngx_conf_file.h:44">NGX_CONF_FLAG</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L943" title="core/ngx_conf_file.c:943">ngx_conf_set_flag_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, master),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;timer_resolution&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1177" title="core/ngx_conf_file.c:1177">ngx_conf_set_msec_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, timer_resolution),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;pid&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L983" title="core/ngx_conf_file.c:983">ngx_conf_set_str_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, pid),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;lock_file&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L983" title="core/ngx_conf_file.c:983">ngx_conf_set_str_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, lock_file),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_processes&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L1338" title="core/nginx.c:1338">ngx_set_worker_processes</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;debug_points&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1269" title="core/ngx_conf_file.c:1269">ngx_conf_set_enum_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, debug_points),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &amp;<a href="#L28" title="core/nginx.c:28">ngx_debug_points</a> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;user&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L33" title="core/ngx_conf_file.h:33">NGX_CONF_TAKE12</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L1113" title="core/nginx.c:1113">ngx_set_user</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_priority&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L1206" title="core/nginx.c:1206">ngx_set_priority</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_cpu_affinity&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L46" title="core/ngx_conf_file.h:46">NGX_CONF_1MORE</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L1246" title="core/nginx.c:1246">ngx_set_cpu_affinity</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_rlimit_nofile&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1084" title="core/ngx_conf_file.c:1084">ngx_conf_set_num_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, rlimit_nofile),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_rlimit_core&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1146" title="core/ngx_conf_file.c:1146">ngx_conf_set_off_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, rlimit_core),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_rlimit_sigpending&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1084" title="core/ngx_conf_file.c:1084">ngx_conf_set_num_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, rlimit_sigpending),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;working_directory&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L983" title="core/ngx_conf_file.c:983">ngx_conf_set_str_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, working_directory),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;env&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L1176" title="core/nginx.c:1176">ngx_set_env</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li><span class="PreProc">#if (NGX_THREADS)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;worker_threads&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1084" title="core/ngx_conf_file.c:1084">ngx_conf_set_num_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, worker_threads),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; { <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;thread_stack_size&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L52" title="core/ngx_conf_file.h:52">NGX_MAIN_CONF</a>|<a href="ngx_conf_file.h.html#L50" title="core/ngx_conf_file.h:50">NGX_DIRECT_CONF</a>|<a href="ngx_conf_file.h.html#L23" title="core/ngx_conf_file.h:23">NGX_CONF_TAKE1</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L1115" title="core/ngx_conf_file.c:1115">ngx_conf_set_size_slot</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; offsetof(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>, thread_stack_size),<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Constant">NULL</span> },<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.h.html#L87" title="core/ngx_conf_file.h:87">ngx_null_command</a><br/></li>
<li>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L164">&#x200c;</a><span class="Type">static</span> <a href="ngx_conf_file.h.html#L143" title="core/ngx_conf_file.h:143">ngx_core_module_t</a>&nbsp; <span class="linkable">ngx_core_module_ctx</span> = {<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L40" title="core/ngx_string.h:40">ngx_string</a>(<span class="Constant">&quot;core&quot;</span>),<br/></li>
<li>&nbsp; &nbsp; <a href="#L929" title="core/nginx.c:929">ngx_core_module_create_conf</a>,<br/></li>
<li>&nbsp; &nbsp; <a href="#L978" title="core/nginx.c:978">ngx_core_module_init_conf</a><br/></li>
<li>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L171">&#x200c;</a><a href="ngx_core.h.html#L12" title="core/ngx_core.h:12">ngx_module_t</a>&nbsp; <span class="linkable">ngx_core_module</span> = {<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L99" title="core/ngx_conf_file.h:99">NGX_MODULE_V1</a>,<br/></li>
<li>&nbsp; &nbsp; &amp;<a href="#L164" title="core/nginx.c:164">ngx_core_module_ctx</a>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* module context */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L35" title="core/nginx.c:35">ngx_core_commands</a>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">/* module directives */<br/></li>
<li></span>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L71" title="core/ngx_conf_file.h:71">NGX_CORE_MODULE</a>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">/* module type */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* init master */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* init module */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* init process */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* init thread */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* exit thread */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* exit process */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">NULL</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* exit master */<br/></li>
<li></span>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L100" title="core/ngx_conf_file.h:100">NGX_MODULE_V1_PADDING</a><br/></li>
<li>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L187">&#x200c;</a><a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="linkable">ngx_max_module</span>;<br/></li>
<li><br/></li>
<li><a id="L189">&#x200c;</a><span class="Type">static</span> <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp;&nbsp; <span class="linkable">ngx_show_help</span>;<br/></li>
<li><a id="L190">&#x200c;</a><span class="Type">static</span> <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp;&nbsp; <span class="linkable">ngx_show_version</span>;<br/></li>
<li><a id="L191">&#x200c;</a><span class="Type">static</span> <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp;&nbsp; <span class="linkable">ngx_show_configure</span>;<br/></li>
<li><a id="L192">&#x200c;</a><span class="Type">static</span> u_char&nbsp; &nbsp; &nbsp; *<span class="linkable">ngx_prefix</span>;<br/></li>
<li><a id="L193">&#x200c;</a><span class="Type">static</span> u_char&nbsp; &nbsp; &nbsp; *<span class="linkable">ngx_conf_file</span>;<br/></li>
<li><a id="L194">&#x200c;</a><span class="Type">static</span> u_char&nbsp; &nbsp; &nbsp; *<span class="linkable">ngx_conf_params</span>;<br/></li>
<li><a id="L195">&#x200c;</a><span class="Type">static</span> <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; *<span class="linkable">ngx_signal</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L198">&#x200c;</a><span class="Type">static</span> <span class="Type">char</span> **<span class="linkable">ngx_os_environ</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">int</span> <a href="ngx_config.h.html#L73" title="core/ngx_config.h:73">ngx_cdecl</a><br/></li>
<li><a id="L202">&#x200c;</a><span class="linkable">main</span>(<span class="Type">int</span> argc, <span class="Type">char</span> *<span class="Type">const</span> *argv)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; i;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_core.h.html#L17" title="core/ngx_core.h:17">ngx_log_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *log;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a>&nbsp; &nbsp; &nbsp; *cycle, init_cycle;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_darwin_init.c.html#L62" title="os/unix/ngx_darwin_init.c:62">ngx_debug_init</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_errno.c.html#L46" title="os/unix/ngx_errno.c:46">ngx_strerror_init</a>() != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L668" title="core/nginx.c:668">ngx_get_options</a>(argc, argv) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L190" title="core/nginx.c:190">ngx_show_version</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L249" title="core/ngx_log.h:249">ngx_write_stderr</a>(<span class="Constant">&quot;<a href="../http/modules/perl/ngx_http_perl_module.h.html#L21" title="http/modules/perl/ngx_http_perl_module.h:21">nginx</a> version: &quot;</span> <a href="nginx.h.html#L17" title="core/nginx.h:17">NGINX_VER_BUILD</a> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L189" title="core/nginx.c:189">ngx_show_help</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L249" title="core/ngx_log.h:249">ngx_write_stderr</a>(<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Usage: <a href="../http/modules/perl/ngx_http_perl_module.h.html#L21" title="http/modules/perl/ngx_http_perl_module.h:21">nginx</a> [-?hvVtq] [-s signal] [-c filename] &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;[-p prefix] [-g directives]&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Options:&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -?,-h&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; : this help&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -v&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : show version and exit&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -V&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : show version and configure options then exit&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -t&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : test configuration and exit&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -q&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : suppress non-error messages &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;during configuration testing&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -s signal&nbsp; &nbsp;&nbsp; : send signal to a master process: &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;stop, quit, reopen, reload&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li><span class="PreProc">#ifdef NGX_PREFIX<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -p prefix&nbsp; &nbsp;&nbsp; : <a href="../event/modules/ngx_rtsig_module.c.html#L75" title="event/modules/ngx_rtsig_module.c:75">set</a> prefix path (default: &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; NGX_PREFIX <span class="Constant">&quot;)&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -p prefix&nbsp; &nbsp;&nbsp; : <a href="../event/modules/ngx_rtsig_module.c.html#L75" title="event/modules/ngx_rtsig_module.c:75">set</a> prefix path (default: NONE)&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -c filename&nbsp;&nbsp; : <a href="../event/modules/ngx_rtsig_module.c.html#L75" title="event/modules/ngx_rtsig_module.c:75">set</a> configuration file (default: &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; NGX_CONF_PATH <span class="Constant">&quot;)&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;&nbsp; -g directives : <a href="../event/modules/ngx_rtsig_module.c.html#L75" title="event/modules/ngx_rtsig_module.c:75">set</a> global directives out of configuration &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;file&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L191" title="core/nginx.c:191">ngx_show_configure</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L249" title="core/ngx_log.h:249">ngx_write_stderr</a>(<br/></li>
<li><span class="PreProc">#ifdef NGX_COMPILER<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;built by &quot;</span> NGX_COMPILER <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#if (NGX_SSL)<br/></li>
<li></span><span class="PreProc">#ifdef SSL_CTRL_SET_TLSEXT_HOSTNAME<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;TLS SNI support enabled&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;TLS SNI support disabled&quot;</span> <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;configure arguments:&quot;</span> NGX_CONFIGURE <a href="../os/unix/ngx_files.h.html#L158" title="os/unix/ngx_files.h:158">NGX_LINEFEED</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!<a href="ngx_cycle.c.html#L26" title="core/ngx_cycle.c:26">ngx_test_config</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* </span><span class="Todo">TODO</span><span class="Comment"> */</span> <a href="../os/unix/ngx_posix_init.c.html#L14" title="os/unix/ngx_posix_init.c:14">ngx_max_sockets</a> = -<span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_times.c.html#L63" title="core/ngx_times.c:63">ngx_time_init</a>();<br/></li>
<li><br/></li>
<li><span class="PreProc">#if (NGX_PCRE)<br/></li>
<li></span>&nbsp; &nbsp; <a href="ngx_regex.c.html#L73" title="core/ngx_regex.c:73">ngx_regex_init</a>();<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L36" title="os/unix/ngx_process_cycle.c:36">ngx_pid</a> = <a href="../os/unix/ngx_process.h.html#L56" title="os/unix/ngx_process.h:56">ngx_getpid</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; log = <a href="ngx_log.c.html#L287" title="core/ngx_log.c:287">ngx_log_init</a>(<a href="#L192" title="core/nginx.c:192">ngx_prefix</a>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (log == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* STUB */<br/></li>
<li></span><span class="PreProc">#if (NGX_OPENSSL)<br/></li>
<li></span>&nbsp; &nbsp; <a href="../event/ngx_event_openssl.c.html#L109" title="event/ngx_event_openssl.c:109">ngx_ssl_init</a>(log);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * init_cycle-&gt;log is required for signal handlers and<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="#L833" title="core/nginx.c:833">ngx_process_options</a>()<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L86" title="core/ngx_string.h:86">ngx_memzero</a>(&amp;init_cycle, <span class="Statement">sizeof</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a>));<br/></li>
<li>&nbsp; &nbsp; init_cycle.log = log;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.c.html#L20" title="core/ngx_cycle.c:20">ngx_cycle</a> = &amp;init_cycle;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; init_cycle.pool = <a href="ngx_palloc.c.html#L17" title="core/ngx_palloc.c:17">ngx_create_pool</a>(<span class="Constant">1024</span>, log);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (init_cycle.pool == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L791" title="core/nginx.c:791">ngx_save_argv</a>(&amp;init_cycle, argc, argv) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L833" title="core/nginx.c:833">ngx_process_options</a>(&amp;init_cycle) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_posix_init.c.html#L33" title="os/unix/ngx_posix_init.c:33">ngx_os_init</a>(log) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="ngx_crc32.c.html#L106" title="core/ngx_crc32.c:106">ngx_crc32_table_init</a>() requires <a href="../os/unix/ngx_alloc.c.html#L14" title="os/unix/ngx_alloc.c:14">ngx_cacheline_size</a> <a href="../event/modules/ngx_rtsig_module.c.html#L75" title="event/modules/ngx_rtsig_module.c:75">set</a> in <a href="../os/unix/ngx_posix_init.c.html#L33" title="os/unix/ngx_posix_init.c:33">ngx_os_init</a>()<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_crc32.c.html#L106" title="core/ngx_crc32.c:106">ngx_crc32_table_init</a>() != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L415" title="core/nginx.c:415">ngx_add_inherited_sockets</a>(&amp;init_cycle) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L187" title="core/nginx.c:187">ngx_max_module</a> = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; ngx_modules[i]; i++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ngx_modules[i]-&gt;index = <a href="#L187" title="core/nginx.c:187">ngx_max_module</a>++;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; cycle = <a href="ngx_cycle.c.html#L40" title="core/ngx_cycle.c:40">ngx_init_cycle</a>(&amp;init_cycle);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (cycle == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_cycle.c.html#L26" title="core/ngx_cycle.c:26">ngx_test_config</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;configuration file </span><span class="Special">%s</span><span class="Constant"> test failed&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; init_cycle.conf_file.data);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_cycle.c.html#L26" title="core/ngx_cycle.c:26">ngx_test_config</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!<a href="ngx_cycle.c.html#L27" title="core/ngx_cycle.c:27">ngx_quiet_mode</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;configuration file </span><span class="Special">%s</span><span class="Constant"> test is successful&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; cycle-&gt;conf_file.data);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L195" title="core/nginx.c:195">ngx_signal</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_cycle.c.html#L964" title="core/ngx_cycle.c:964">ngx_signal_process</a>(cycle, <a href="#L195" title="core/nginx.c:195">ngx_signal</a>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_posix_init.c.html#L85" title="os/unix/ngx_posix_init.c:85">ngx_os_status</a>(cycle-&gt;log);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.c.html#L20" title="core/ngx_cycle.c:20">ngx_cycle</a> = cycle;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf = (<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a> *) <a href="ngx_conf_file.h.html#L217" title="core/ngx_conf_file.h:217">ngx_get_conf</a>(cycle-&gt;conf_ctx, <a href="#L171" title="core/nginx.c:171">ngx_core_module</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;master &amp;&amp; <a href="../os/unix/ngx_process_cycle.c.html#L35" title="os/unix/ngx_process_cycle.c:35">ngx_process</a> == <a href="../os/unix/ngx_process_cycle.h.html#L23" title="os/unix/ngx_process_cycle.h:23">NGX_PROCESS_SINGLE</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L35" title="os/unix/ngx_process_cycle.c:35">ngx_process</a> = <a href="../os/unix/ngx_process_cycle.h.html#L24" title="os/unix/ngx_process_cycle.h:24">NGX_PROCESS_MASTER</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#if !(NGX_WIN32)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_process.c.html#L284" title="os/unix/ngx_process.c:284">ngx_init_signals</a>(cycle-&gt;log) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!<a href="../os/unix/ngx_process_cycle.c.html#L51" title="os/unix/ngx_process_cycle.c:51">ngx_inherited</a> &amp;&amp; ccf-&gt;daemon) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_daemon.c.html#L13" title="os/unix/ngx_daemon.c:13">ngx_daemon</a>(cycle-&gt;log) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L52" title="os/unix/ngx_process_cycle.c:52">ngx_daemonized</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_process_cycle.c.html#L51" title="os/unix/ngx_process_cycle.c:51">ngx_inherited</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L52" title="os/unix/ngx_process_cycle.c:52">ngx_daemonized</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_cycle.c.html#L902" title="core/ngx_cycle.c:902">ngx_create_pidfile</a>(&amp;ccf-&gt;pid, cycle-&gt;log) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_log.c.html#L411" title="core/ngx_log.c:411">ngx_log_redirect_stderr</a>(cycle) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (log-&gt;file-&gt;fd != <a href="../os/unix/ngx_files.h.html#L371" title="os/unix/ngx_files.h:371">ngx_stderr</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_files.h.html#L109" title="os/unix/ngx_files.h:109">ngx_close_file</a>(log-&gt;file-&gt;fd) == <a href="../os/unix/ngx_files.h.html#L50" title="os/unix/ngx_files.h:50">NGX_FILE_ERROR</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L18" title="core/ngx_log.h:18">NGX_LOG_ALERT</a>, cycle-&gt;log, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_files.h.html#L110" title="os/unix/ngx_files.h:110">ngx_close_file_n</a> <span class="Constant">&quot; built-in log failed&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_log.c.html#L55" title="core/ngx_log.c:55">ngx_use_stderr</a> = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_process_cycle.c.html#L35" title="os/unix/ngx_process_cycle.c:35">ngx_process</a> == <a href="../os/unix/ngx_process_cycle.h.html#L23" title="os/unix/ngx_process_cycle.h:23">NGX_PROCESS_SINGLE</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L298" title="os/unix/ngx_process_cycle.c:298">ngx_single_process_cycle</a>(cycle);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L83" title="os/unix/ngx_process_cycle.c:83">ngx_master_process_cycle</a>(cycle);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a><br/></li>
<li><a id="L415">&#x200c;</a><span class="linkable">ngx_add_inherited_sockets</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; u_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *p, *v, *inherited;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; s;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_connection.h.html#L16" title="core/ngx_connection.h:16">ngx_listening_t</a>&nbsp; *ls;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; inherited = (u_char *) getenv(<a href="nginx.h.html#L22" title="core/nginx.h:22">NGINX_VAR</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (inherited == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L22" title="core/ngx_log.h:22">NGX_LOG_NOTICE</a>, cycle-&gt;log, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;using inherited sockets from </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>, inherited);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_array.h.html#L32" title="core/ngx_array.h:32">ngx_array_init</a>(&amp;cycle-&gt;listening, cycle-&gt;pool, <span class="Constant">10</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">sizeof</span>(<a href="ngx_connection.h.html#L16" title="core/ngx_connection.h:16">ngx_listening_t</a>))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (p = inherited, v = p; *p; p++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*p == <span class="Constant">':'</span> || *p == <span class="Constant">';'</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s = <a href="ngx_string.c.html#L898" title="core/ngx_string.c:898">ngx_atoi</a>(v, p - v);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (s == <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cycle-&gt;log, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;invalid socket number </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant"> in &quot;</span> <a href="nginx.h.html#L22" title="core/nginx.h:22">NGINX_VAR</a><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot; environment variable, ignoring the rest&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot; of the variable&quot;</span>, v);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v = p + <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ls = <a href="ngx_array.c.html#L48" title="core/ngx_array.c:48">ngx_array_push</a>(&amp;cycle-&gt;listening);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ls == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L86" title="core/ngx_string.h:86">ngx_memzero</a>(ls, <span class="Statement">sizeof</span>(<a href="ngx_connection.h.html#L16" title="core/ngx_connection.h:16">ngx_listening_t</a>));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ls-&gt;fd = (<a href="../os/unix/ngx_socket.h.html#L17" title="os/unix/ngx_socket.h:17">ngx_socket_t</a>) s;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L51" title="os/unix/ngx_process_cycle.c:51">ngx_inherited</a> = <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_connection.c.html#L94" title="core/ngx_connection.c:94">ngx_set_inherited_sockets</a>(cycle);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">char</span> **<br/></li>
<li><a id="L468">&#x200c;</a><span class="linkable">ngx_set_environment</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle, <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a> *last)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; **p, **env;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *var;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; i, n;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp;&nbsp; *ccf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf = (<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a> *) <a href="ngx_conf_file.h.html#L217" title="core/ngx_conf_file.h:217">ngx_get_conf</a>(cycle-&gt;conf_ctx, <a href="#L171" title="core/nginx.c:171">ngx_core_module</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (last == <span class="Constant">NULL</span> &amp;&amp; ccf-&gt;environment) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> ccf-&gt;environment;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; var = ccf-&gt;env.elts;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; ccf-&gt;env.nelts; i++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_string.h.html#L57" title="core/ngx_string.h:57">ngx_strcmp</a>(var[i].data, <span class="Constant">&quot;TZ&quot;</span>) == <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; || <a href="ngx_string.h.html#L53" title="core/ngx_string.h:53">ngx_strncmp</a>(var[i].data, <span class="Constant">&quot;TZ=&quot;</span>, <span class="Constant">3</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> tz_found;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; var = <a href="ngx_array.c.html#L48" title="core/ngx_array.c:48">ngx_array_push</a>(&amp;ccf-&gt;env);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (var == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; var-&gt;len = <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; var-&gt;data = (u_char *) <span class="Constant">&quot;TZ&quot;</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; var = ccf-&gt;env.elts;<br/></li>
<li><br/></li>
<li><span class="Statement">tz_found</span><span class="cUserCont">:<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; n = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; ccf-&gt;env.nelts; i++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (var[i].data[var[i].len] == <span class="Constant">'='</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (p = <a href="#L198" title="core/nginx.c:198">ngx_os_environ</a>; *p; p++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_string.h.html#L53" title="core/ngx_string.h:53">ngx_strncmp</a>(*p, var[i].data, var[i].len) == <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; (*p)[var[i].len] == <span class="Constant">'='</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (last) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; env = <a href="../os/unix/ngx_alloc.c.html#L18" title="os/unix/ngx_alloc.c:18">ngx_alloc</a>((*last + n + <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">char</span> *), cycle-&gt;log);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *last = n;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; env = <a href="ngx_palloc.c.html#L120" title="core/ngx_palloc.c:120">ngx_palloc</a>(cycle-&gt;pool, (n + <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">char</span> *));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (env == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; n = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; ccf-&gt;env.nelts; i++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (var[i].data[var[i].len] == <span class="Constant">'='</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; env[n++] = (<span class="Type">char</span> *) var[i].data;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (p = <a href="#L198" title="core/nginx.c:198">ngx_os_environ</a>; *p; p++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_string.h.html#L53" title="core/ngx_string.h:53">ngx_strncmp</a>(*p, var[i].data, var[i].len) == <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; (*p)[var[i].len] == <span class="Constant">'='</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; env[n++] = *p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; env[n] = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (last == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;environment = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; environ = env;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> env;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a href="../os/unix/ngx_process.h.html#L16" title="os/unix/ngx_process.h:16">ngx_pid_t</a><br/></li>
<li><a id="L567">&#x200c;</a><span class="linkable">ngx_exec_new_binary</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle, <span class="Type">char</span> *<span class="Type">const</span> *argv)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; **env, *var;<br/></li>
<li>&nbsp; &nbsp; u_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *p;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; i, n;<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.h.html#L16" title="os/unix/ngx_process.h:16">ngx_pid_t</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pid;<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.h.html#L44" title="os/unix/ngx_process.h:44">ngx_exec_ctx_t</a>&nbsp; &nbsp;&nbsp; ctx;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp;&nbsp; *ccf;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_connection.h.html#L16" title="core/ngx_connection.h:16">ngx_listening_t</a>&nbsp;&nbsp; *ls;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L86" title="core/ngx_string.h:86">ngx_memzero</a>(&amp;ctx, <span class="Statement">sizeof</span>(<a href="../os/unix/ngx_process.h.html#L44" title="os/unix/ngx_process.h:44">ngx_exec_ctx_t</a>));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ctx.path = argv[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; ctx.name = <span class="Constant">&quot;new binary process&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; ctx.argv = argv;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; n = <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; env = <a href="#L468" title="core/nginx.c:468">ngx_set_environment</a>(cycle, &amp;n);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (env == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="../os/unix/ngx_process.h.html#L18" title="os/unix/ngx_process.h:18">NGX_INVALID_PID</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; var = <a href="../os/unix/ngx_alloc.c.html#L18" title="os/unix/ngx_alloc.c:18">ngx_alloc</a>(<span class="Statement">sizeof</span>(<a href="nginx.h.html#L22" title="core/nginx.h:22">NGINX_VAR</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + cycle-&gt;listening.nelts * (<a href="ngx_config.h.html#L83" title="core/ngx_config.h:83">NGX_INT32_LEN</a> + <span class="Constant">1</span>) + <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;log);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (var == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_alloc.h.html#L19" title="os/unix/ngx_alloc.h:19">ngx_free</a>(env);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="../os/unix/ngx_process.h.html#L18" title="os/unix/ngx_process.h:18">NGX_INVALID_PID</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = <a href="ngx_string.h.html#L93" title="core/ngx_string.h:93">ngx_cpymem</a>(var, <a href="nginx.h.html#L22" title="core/nginx.h:22">NGINX_VAR</a> <span class="Constant">&quot;=&quot;</span>, <span class="Statement">sizeof</span>(<a href="nginx.h.html#L22" title="core/nginx.h:22">NGINX_VAR</a>));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ls = cycle-&gt;listening.elts;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; cycle-&gt;listening.nelts; i++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = <a href="ngx_string.c.html#L105" title="core/ngx_string.c:105">ngx_sprintf</a>(p, <span class="Constant">&quot;</span><span class="Special">%u</span><span class="Constant">d;&quot;</span>, ls[i].fd);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; *p = <span class="Special">'\0'</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; env[n++] = var;<br/></li>
<li><br/></li>
<li><span class="PreProc">#if (<a href="../os/unix/ngx_setproctitle.h.html#L26" title="os/unix/ngx_setproctitle.h:26">NGX_SETPROCTITLE_USES_ENV</a>)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* allocate the spare 300 bytes for the new binary process title */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; env[n++] = <span class="Constant">&quot;SPARE=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; env[n] = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#if (NGX_DEBUG)<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; **e;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (e = env; *e; e++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L135" title="core/ngx_log.h:135">ngx_log_debug1</a>(<a href="ngx_log.h.html#L26" title="core/ngx_log.h:26">NGX_LOG_DEBUG_CORE</a>, cycle-&gt;log, <span class="Constant">0</span>, <span class="Constant">&quot;env: </span><span class="Special">%s</span><span class="Constant">&quot;</span>, *e);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; ctx.envp = (<span class="Type">char</span> *<span class="Type">const</span> *) env;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf = (<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a> *) <a href="ngx_conf_file.h.html#L217" title="core/ngx_conf_file.h:217">ngx_get_conf</a>(cycle-&gt;conf_ctx, <a href="#L171" title="core/nginx.c:171">ngx_core_module</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_files.h.html#L161" title="os/unix/ngx_files.h:161">ngx_rename_file</a>(ccf-&gt;pid.data, ccf-&gt;oldpid.data) == <a href="../os/unix/ngx_files.h.html#L50" title="os/unix/ngx_files.h:50">NGX_FILE_ERROR</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L18" title="core/ngx_log.h:18">NGX_LOG_ALERT</a>, cycle-&gt;log, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_files.h.html#L162" title="os/unix/ngx_files.h:162">ngx_rename_file_n</a> <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant"> to </span><span class="Special">%s</span><span class="Constant"> failed &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;before executing new binary process </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;pid.data, ccf-&gt;oldpid.data, argv[<span class="Constant">0</span>]);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_alloc.h.html#L19" title="os/unix/ngx_alloc.h:19">ngx_free</a>(env);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_alloc.h.html#L19" title="os/unix/ngx_alloc.h:19">ngx_free</a>(var);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="../os/unix/ngx_process.h.html#L18" title="os/unix/ngx_process.h:18">NGX_INVALID_PID</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; pid = <a href="../os/unix/ngx_process.c.html#L261" title="os/unix/ngx_process.c:261">ngx_execute</a>(cycle, &amp;ctx);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (pid == <a href="../os/unix/ngx_process.h.html#L18" title="os/unix/ngx_process.h:18">NGX_INVALID_PID</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_files.h.html#L161" title="os/unix/ngx_files.h:161">ngx_rename_file</a>(ccf-&gt;oldpid.data, ccf-&gt;pid.data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; == <a href="../os/unix/ngx_files.h.html#L50" title="os/unix/ngx_files.h:50">NGX_FILE_ERROR</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L18" title="core/ngx_log.h:18">NGX_LOG_ALERT</a>, cycle-&gt;log, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_files.h.html#L162" title="os/unix/ngx_files.h:162">ngx_rename_file_n</a> <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant"> back to </span><span class="Special">%s</span><span class="Constant"> failed after &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;an attempt to execute new binary process </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;oldpid.data, ccf-&gt;pid.data, argv[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_alloc.h.html#L19" title="os/unix/ngx_alloc.h:19">ngx_free</a>(env);<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_alloc.h.html#L19" title="os/unix/ngx_alloc.h:19">ngx_free</a>(var);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> pid;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a><br/></li>
<li><a id="L668">&#x200c;</a><span class="linkable">ngx_get_options</span>(<span class="Type">int</span> argc, <span class="Type">char</span> *<span class="Type">const</span> *argv)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; u_char&nbsp; &nbsp;&nbsp; *p;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a>&nbsp;&nbsp; i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; argc; i++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = (u_char *) argv[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*p++ != <span class="Constant">'-'</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;invalid option: </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>, argv[i]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (*p) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (*p++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'?'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'h'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L190" title="core/nginx.c:190">ngx_show_version</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L189" title="core/nginx.c:189">ngx_show_help</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'v'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L190" title="core/nginx.c:190">ngx_show_version</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'V'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L190" title="core/nginx.c:190">ngx_show_version</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L191" title="core/nginx.c:191">ngx_show_configure</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'t'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_cycle.c.html#L26" title="core/ngx_cycle.c:26">ngx_test_config</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'q'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_cycle.c.html#L27" title="core/ngx_cycle.c:27">ngx_quiet_mode</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'p'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*p) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L192" title="core/nginx.c:192">ngx_prefix</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (argv[++i]) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L192" title="core/nginx.c:192">ngx_prefix</a> = (u_char *) argv[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;option </span><span class="Special">\&quot;</span><span class="Constant">-p</span><span class="Special">\&quot;</span><span class="Constant"> requires directory name&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'c'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*p) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L193" title="core/nginx.c:193">ngx_conf_file</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (argv[++i]) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L193" title="core/nginx.c:193">ngx_conf_file</a> = (u_char *) argv[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;option </span><span class="Special">\&quot;</span><span class="Constant">-c</span><span class="Special">\&quot;</span><span class="Constant"> requires file name&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'g'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*p) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L194" title="core/nginx.c:194">ngx_conf_params</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (argv[++i]) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L194" title="core/nginx.c:194">ngx_conf_params</a> = (u_char *) argv[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;option </span><span class="Special">\&quot;</span><span class="Constant">-g</span><span class="Special">\&quot;</span><span class="Constant"> requires parameter&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'s'</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*p) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L195" title="core/nginx.c:195">ngx_signal</a> = (<span class="Type">char</span> *) p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> <span class="Statement">if</span> (argv[++i]) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L195" title="core/nginx.c:195">ngx_signal</a> = argv[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;option </span><span class="Special">\&quot;</span><span class="Constant">-s</span><span class="Special">\&quot;</span><span class="Constant"> requires parameter&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_string.h.html#L57" title="core/ngx_string.h:57">ngx_strcmp</a>(<a href="#L195" title="core/nginx.c:195">ngx_signal</a>, <span class="Constant">&quot;stop&quot;</span>) == <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; || <a href="ngx_string.h.html#L57" title="core/ngx_string.h:57">ngx_strcmp</a>(<a href="#L195" title="core/nginx.c:195">ngx_signal</a>, <span class="Constant">&quot;quit&quot;</span>) == <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; || <a href="ngx_string.h.html#L57" title="core/ngx_string.h:57">ngx_strcmp</a>(<a href="#L195" title="core/nginx.c:195">ngx_signal</a>, <span class="Constant">&quot;reopen&quot;</span>) == <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; || <a href="ngx_string.h.html#L57" title="core/ngx_string.h:57">ngx_strcmp</a>(<a href="#L195" title="core/nginx.c:195">ngx_signal</a>, <span class="Constant">&quot;reload&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L35" title="os/unix/ngx_process_cycle.c:35">ngx_process</a> = <a href="../os/unix/ngx_process_cycle.h.html#L25" title="os/unix/ngx_process_cycle.h:25">NGX_PROCESS_SIGNALLER</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> next;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;invalid option: </span><span class="Special">\&quot;</span><span class="Constant">-s </span><span class="Special">%s\&quot;</span><span class="Constant">&quot;</span>, <a href="#L195" title="core/nginx.c:195">ngx_signal</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li><br/></li>
<li><span class="cUserCont">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">default</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<span class="Constant">0</span>, <span class="Constant">&quot;invalid option: </span><span class="Special">\&quot;%c\&quot;</span><span class="Constant">&quot;</span>, *(p - <span class="Constant">1</span>));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="cUserCont">&nbsp; &nbsp; </span><span class="Statement">next</span><span class="cUserCont">:<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a><br/></li>
<li><a id="L791">&#x200c;</a><span class="linkable">ngx_save_argv</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle, <span class="Type">int</span> argc, <span class="Type">char</span> *<span class="Type">const</span> *argv)<br/></li>
<li>{<br/></li>
<li><span class="PreProc">#if (NGX_FREEBSD)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L31" title="os/unix/ngx_process.c:31">ngx_os_argv</a> = (<span class="Type">char</span> **) argv;<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L29" title="os/unix/ngx_process.c:29">ngx_argc</a> = argc;<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a> = (<span class="Type">char</span> **) argv;<br/></li>
<li><br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; &nbsp; <span class="Type">size_t</span>&nbsp; &nbsp;&nbsp; len;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a>&nbsp; i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L31" title="os/unix/ngx_process.c:31">ngx_os_argv</a> = (<span class="Type">char</span> **) argv;<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L29" title="os/unix/ngx_process.c:29">ngx_argc</a> = argc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a> = <a href="../os/unix/ngx_alloc.c.html#L18" title="os/unix/ngx_alloc.c:18">ngx_alloc</a>((argc + <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">char</span> *), cycle-&gt;log);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a> == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; argc; i++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; len = <a href="ngx_string.h.html#L61" title="core/ngx_string.h:61">ngx_strlen</a>(argv[i]) + <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a>[i] = <a href="../os/unix/ngx_alloc.c.html#L18" title="os/unix/ngx_alloc.c:18">ngx_alloc</a>(len, cycle-&gt;log);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a>[i] == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (<span class="Type">void</span>) <a href="ngx_string.c.html#L33" title="core/ngx_string.c:33">ngx_cpystrn</a>((u_char *) <a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a>[i], (u_char *) argv[i], len);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process.c.html#L30" title="os/unix/ngx_process.c:30">ngx_argv</a>[i] = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L198" title="core/nginx.c:198">ngx_os_environ</a> = environ;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <a href="ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a><br/></li>
<li><a id="L833">&#x200c;</a><span class="linkable">ngx_process_options</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; u_char&nbsp; *p;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">size_t</span>&nbsp;&nbsp; len;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L192" title="core/nginx.c:192">ngx_prefix</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; len = <a href="ngx_string.h.html#L61" title="core/ngx_string.h:61">ngx_strlen</a>(<a href="#L192" title="core/nginx.c:192">ngx_prefix</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = <a href="#L192" title="core/nginx.c:192">ngx_prefix</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (len &amp;&amp; !<a href="../os/unix/ngx_files.h.html#L201" title="os/unix/ngx_files.h:201">ngx_path_separator</a>(p[len - <span class="Constant">1</span>])) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p = <a href="ngx_palloc.c.html#L150" title="core/ngx_palloc.c:150">ngx_pnalloc</a>(cycle-&gt;pool, len + <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (p == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.c.html#L1947" title="core/ngx_string.c:1947">ngx_memcpy</a>(p, <a href="#L192" title="core/nginx.c:192">ngx_prefix</a>, len);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p[len++] = <span class="Constant">'/'</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_prefix.len = len;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_prefix.data = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;prefix.len = len;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;prefix.data = p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifndef NGX_PREFIX<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = <a href="ngx_palloc.c.html#L150" title="core/ngx_palloc.c:150">ngx_pnalloc</a>(cycle-&gt;pool, <a href="../os/unix/ngx_files.h.html#L207" title="os/unix/ngx_files.h:207">NGX_MAX_PATH</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (p == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_files.h.html#L199" title="os/unix/ngx_files.h:199">ngx_getcwd</a>(p, <a href="../os/unix/ngx_files.h.html#L207" title="os/unix/ngx_files.h:207">NGX_MAX_PATH</a>) == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.c.html#L227" title="core/ngx_log.c:227">ngx_log_stderr</a>(<a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>, <span class="Constant">&quot;[emerg]: &quot;</span> <a href="../os/unix/ngx_files.h.html#L200" title="os/unix/ngx_files.h:200">ngx_getcwd_n</a> <span class="Constant">&quot; failed&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; len = <a href="ngx_string.h.html#L61" title="core/ngx_string.h:61">ngx_strlen</a>(p);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p[len++] = <span class="Constant">'/'</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_prefix.len = len;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_prefix.data = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;prefix.len = len;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;prefix.data = p;<br/></li>
<li><br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifdef NGX_CONF_PREFIX<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L42" title="core/ngx_string.h:42">ngx_str_set</a>(&amp;cycle-&gt;conf_prefix, NGX_CONF_PREFIX);<br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L42" title="core/ngx_string.h:42">ngx_str_set</a>(&amp;cycle-&gt;conf_prefix, NGX_PREFIX);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L42" title="core/ngx_string.h:42">ngx_str_set</a>(&amp;cycle-&gt;prefix, NGX_PREFIX);<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L193" title="core/nginx.c:193">ngx_conf_file</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_file.len = <a href="ngx_string.h.html#L61" title="core/ngx_string.h:61">ngx_strlen</a>(<a href="#L193" title="core/nginx.c:193">ngx_conf_file</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_file.data = <a href="#L193" title="core/nginx.c:193">ngx_conf_file</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L42" title="core/ngx_string.h:42">ngx_str_set</a>(&amp;cycle-&gt;conf_file, NGX_CONF_PATH);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_conf_file.c.html#L804" title="core/ngx_conf_file.c:804">ngx_conf_full_name</a>(cycle, &amp;cycle-&gt;conf_file, <span class="Constant">0</span>) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (p = cycle-&gt;conf_file.data + cycle-&gt;conf_file.len - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; p &gt; cycle-&gt;conf_file.data;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; p--)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../os/unix/ngx_files.h.html#L201" title="os/unix/ngx_files.h:201">ngx_path_separator</a>(*p)) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_prefix.len = p - <a href="ngx_cycle.c.html#L20" title="core/ngx_cycle.c:20">ngx_cycle</a>-&gt;conf_file.data + <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_prefix.data = <a href="ngx_cycle.c.html#L20" title="core/ngx_cycle.c:20">ngx_cycle</a>-&gt;conf_file.data;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L194" title="core/nginx.c:194">ngx_conf_params</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_param.len = <a href="ngx_string.h.html#L61" title="core/ngx_string.h:61">ngx_strlen</a>(<a href="#L194" title="core/nginx.c:194">ngx_conf_params</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;conf_param.data = <a href="#L194" title="core/nginx.c:194">ngx_conf_params</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_cycle.c.html#L26" title="core/ngx_cycle.c:26">ngx_test_config</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;log-&gt;log_level = <a href="ngx_log.h.html#L23" title="core/ngx_log.h:23">NGX_LOG_INFO</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> *<br/></li>
<li><a id="L929">&#x200c;</a><span class="linkable">ngx_core_module_create_conf</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf = <a href="ngx_palloc.c.html#L300" title="core/ngx_palloc.c:300">ngx_pcalloc</a>(cycle-&gt;pool, <span class="Statement">sizeof</span>(<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>));<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="../event/modules/ngx_rtsig_module.c.html#L75" title="event/modules/ngx_rtsig_module.c:75">set</a> by <a href="ngx_palloc.c.html#L300" title="core/ngx_palloc.c:300">ngx_pcalloc</a>()<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp;&nbsp; ccf-&gt;pid = NULL;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp;&nbsp; ccf-&gt;oldpid = NULL;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp;&nbsp; ccf-&gt;priority = 0;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp;&nbsp; ccf-&gt;cpu_affinity_n = 0;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp;&nbsp; ccf-&gt;cpu_affinity = NULL;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;daemon = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;master = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;timer_resolution = <a href="ngx_conf_file.h.html#L61" title="core/ngx_conf_file.h:61">NGX_CONF_UNSET_MSEC</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;worker_processes = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;debug_points = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;rlimit_nofile = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;rlimit_core = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;rlimit_sigpending = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;user = (<a href="../os/unix/ngx_user.h.html#L16" title="os/unix/ngx_user.h:16">ngx_uid_t</a>) <a href="ngx_conf_file.h.html#L58" title="core/ngx_conf_file.h:58">NGX_CONF_UNSET_UINT</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;group = (<a href="../os/unix/ngx_user.h.html#L17" title="os/unix/ngx_user.h:17">ngx_gid_t</a>) <a href="ngx_conf_file.h.html#L58" title="core/ngx_conf_file.h:58">NGX_CONF_UNSET_UINT</a>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#if (NGX_THREADS)<br/></li>
<li></span>&nbsp; &nbsp; ccf-&gt;worker_threads = <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;thread_stack_size = <a href="ngx_conf_file.h.html#L60" title="core/ngx_conf_file.h:60">NGX_CONF_UNSET_SIZE</a>;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_array.h.html#L32" title="core/ngx_array.h:32">ngx_array_init</a>(&amp;ccf-&gt;env, cycle-&gt;pool, <span class="Constant">1</span>, <span class="Statement">sizeof</span>(<a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> ccf;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<br/></li>
<li><a id="L978">&#x200c;</a><span class="linkable">ngx_core_module_init_conf</span>(<a href="ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle, <span class="Type">void</span> *conf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf = conf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L221" title="core/ngx_conf_file.h:221">ngx_conf_init_value</a>(ccf-&gt;daemon, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L221" title="core/ngx_conf_file.h:221">ngx_conf_init_value</a>(ccf-&gt;master, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L241" title="core/ngx_conf_file.h:241">ngx_conf_init_msec_value</a>(ccf-&gt;timer_resolution, <span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L221" title="core/ngx_conf_file.h:221">ngx_conf_init_value</a>(ccf-&gt;worker_processes, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L221" title="core/ngx_conf_file.h:221">ngx_conf_init_value</a>(ccf-&gt;debug_points, <span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li><span class="PreProc">#if (<a href="../os/unix/ngx_setaffinity.h.html#L12" title="os/unix/ngx_setaffinity.h:12">NGX_HAVE_CPU_AFFINITY</a>)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;cpu_affinity_n<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; ccf-&gt;cpu_affinity_n != <span class="Constant">1<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; ccf-&gt;cpu_affinity_n != (<a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>) ccf-&gt;worker_processes)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L21" title="core/ngx_log.h:21">NGX_LOG_WARN</a>, cycle-&gt;log, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;the number of </span><span class="Special">\&quot;</span><span class="Constant">worker_processes</span><span class="Special">\&quot;</span><span class="Constant"> is not equal to &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;the number of </span><span class="Special">\&quot;</span><span class="Constant">worker_cpu_affinity</span><span class="Special">\&quot;</span><span class="Constant"> masks, &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;using last mask for remaining worker processes&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if (NGX_THREADS)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L221" title="core/ngx_conf_file.h:221">ngx_conf_init_value</a>(ccf-&gt;worker_threads, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_process_cycle.c.html#L61" title="os/unix/ngx_process_cycle.c:61">ngx_threads_n</a> = ccf-&gt;worker_threads;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.h.html#L236" title="core/ngx_conf_file.h:236">ngx_conf_init_size_value</a>(ccf-&gt;thread_stack_size, <span class="Constant">2</span> * <span class="Constant">1024</span> * <span class="Constant">1024</span>);<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;pid.len == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L42" title="core/ngx_string.h:42">ngx_str_set</a>(&amp;ccf-&gt;pid, NGX_PID_PATH);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_conf_file.c.html#L804" title="core/ngx_conf_file.c:804">ngx_conf_full_name</a>(cycle, &amp;ccf-&gt;pid, <span class="Constant">0</span>) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;oldpid.len = ccf-&gt;pid.len + <span class="Statement">sizeof</span>(<a href="nginx.h.html#L23" title="core/nginx.h:23">NGX_OLDPID_EXT</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;oldpid.data = <a href="ngx_palloc.c.html#L150" title="core/ngx_palloc.c:150">ngx_pnalloc</a>(cycle-&gt;pool, ccf-&gt;oldpid.len);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;oldpid.data == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.c.html#L1947" title="core/ngx_string.c:1947">ngx_memcpy</a>(<a href="ngx_string.h.html#L93" title="core/ngx_string.h:93">ngx_cpymem</a>(ccf-&gt;oldpid.data, ccf-&gt;pid.data, ccf-&gt;pid.len),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="nginx.h.html#L23" title="core/nginx.h:23">NGX_OLDPID_EXT</a>, <span class="Statement">sizeof</span>(<a href="nginx.h.html#L23" title="core/nginx.h:23">NGX_OLDPID_EXT</a>));<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="PreProc">#if !(NGX_WIN32)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;user == (uid_t) <a href="ngx_conf_file.h.html#L58" title="core/ngx_conf_file.h:58">NGX_CONF_UNSET_UINT</a> &amp;&amp; geteuid() == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> group&nbsp;&nbsp; *grp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> passwd&nbsp; *pwd;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_errno.h.html#L70" title="os/unix/ngx_errno.h:70">ngx_set_errno</a>(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pwd = getpwnam(NGX_USER);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (pwd == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cycle-&gt;log, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;getpwnam(</span><span class="Special">\&quot;</span><span class="Constant">&quot;</span> NGX_USER <span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">) failed&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;username = NGX_USER;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;user = pwd-&gt;pw_uid;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../os/unix/ngx_errno.h.html#L70" title="os/unix/ngx_errno.h:70">ngx_set_errno</a>(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; grp = getgrnam(NGX_GROUP);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (grp == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cycle-&gt;log, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;getgrnam(</span><span class="Special">\&quot;</span><span class="Constant">&quot;</span> NGX_GROUP <span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">) failed&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;group = grp-&gt;gr_gid;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;lock_file.len == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.h.html#L42" title="core/ngx_string.h:42">ngx_str_set</a>(&amp;ccf-&gt;lock_file, NGX_LOCK_PATH);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_conf_file.c.html#L804" title="core/ngx_conf_file.c:804">ngx_conf_full_name</a>(cycle, &amp;ccf-&gt;lock_file, <span class="Constant">0</span>) != <a href="ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp; lock_file;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; lock_file = cycle-&gt;old_cycle-&gt;lock_file;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (lock_file.len) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; lock_file.len--;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;lock_file.len != lock_file.len<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; || <a href="ngx_string.h.html#L53" title="core/ngx_string.h:53">ngx_strncmp</a>(ccf-&gt;lock_file.data, lock_file.data, lock_file.len)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; != <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_log.h.html#L83" title="core/ngx_log.h:83">ngx_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cycle-&gt;log, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">lock_file</span><span class="Special">\&quot;</span><span class="Constant"> could not be changed, ignored&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;lock_file.len = lock_file.len + <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; lock_file.len += <span class="Statement">sizeof</span>(<span class="Constant">&quot;.accept&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;lock_file.data = <a href="ngx_string.c.html#L57" title="core/ngx_string.c:57">ngx_pstrdup</a>(cycle-&gt;pool, &amp;lock_file);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (cycle-&gt;lock_file.data == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;lock_file.len = ccf-&gt;lock_file.len + <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; cycle-&gt;lock_file.data = <a href="ngx_palloc.c.html#L150" title="core/ngx_palloc.c:150">ngx_pnalloc</a>(cycle-&gt;pool,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;lock_file.len + <span class="Statement">sizeof</span>(<span class="Constant">&quot;.accept&quot;</span>));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (cycle-&gt;lock_file.data == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_string.c.html#L1947" title="core/ngx_string.c:1947">ngx_memcpy</a>(<a href="ngx_string.h.html#L93" title="core/ngx_string.h:93">ngx_cpymem</a>(cycle-&gt;lock_file.data, ccf-&gt;lock_file.data,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;lock_file.len),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;.accept&quot;</span>, <span class="Statement">sizeof</span>(<span class="Constant">&quot;.accept&quot;</span>));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<br/></li>
<li><a id="L1113">&#x200c;</a><span class="linkable">ngx_set_user</span>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf)<br/></li>
<li>{<br/></li>
<li><span class="PreProc">#if (NGX_WIN32)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L21" title="core/ngx_log.h:21">NGX_LOG_WARN</a>, cf, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">user</span><span class="Special">\&quot;</span><span class="Constant"> is not supported, ignored&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf = conf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *group;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> passwd&nbsp; &nbsp; *pwd;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> group&nbsp; &nbsp;&nbsp; *grp;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *value;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;user != (uid_t) <a href="ngx_conf_file.h.html#L58" title="core/ngx_conf_file.h:58">NGX_CONF_UNSET_UINT</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">&quot;is duplicate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (geteuid() != <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L21" title="core/ngx_log.h:21">NGX_LOG_WARN</a>, cf, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;the </span><span class="Special">\&quot;</span><span class="Constant">user</span><span class="Special">\&quot;</span><span class="Constant"> directive makes sense only &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;if the master process runs &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;with super-user privileges, ignored&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; value = (<a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a> *) cf-&gt;args-&gt;elts;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;username = (<span class="Type">char</span> *) value[<span class="Constant">1</span>].data;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_errno.h.html#L70" title="os/unix/ngx_errno.h:70">ngx_set_errno</a>(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; pwd = getpwnam((<span class="Type">const</span> <span class="Type">char</span> *) value[<span class="Constant">1</span>].data);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (pwd == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cf, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;getpwnam(</span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">) failed&quot;</span>, value[<span class="Constant">1</span>].data);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;user = pwd-&gt;pw_uid;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; group = (<span class="Type">char</span> *) ((cf-&gt;args-&gt;nelts == <span class="Constant">2</span>) ? value[<span class="Constant">1</span>].data : value[<span class="Constant">2</span>].data);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../os/unix/ngx_errno.h.html#L70" title="os/unix/ngx_errno.h:70">ngx_set_errno</a>(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; grp = getgrnam(group);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (grp == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cf, <a href="../os/unix/ngx_errno.h.html#L68" title="os/unix/ngx_errno.h:68">ngx_errno</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;getgrnam(</span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">) failed&quot;</span>, group);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;group = grp-&gt;gr_gid;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<br/></li>
<li><a id="L1176">&#x200c;</a><span class="linkable">ngx_set_env</span>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf = conf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp;&nbsp; *value, *var;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp;&nbsp; i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; var = <a href="ngx_array.c.html#L48" title="core/ngx_array.c:48">ngx_array_push</a>(&amp;ccf-&gt;env);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (var == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; value = cf-&gt;args-&gt;elts;<br/></li>
<li>&nbsp; &nbsp; *var = value[<span class="Constant">1</span>];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; value[<span class="Constant">1</span>].len; i++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (value[<span class="Constant">1</span>].data[i] == <span class="Constant">'='</span>) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var-&gt;len = i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<br/></li>
<li><a id="L1206">&#x200c;</a><span class="linkable">ngx_set_priority</span>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf = conf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *value;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp; &nbsp; &nbsp; &nbsp; n, minus;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;priority != <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">&quot;is duplicate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; value = cf-&gt;args-&gt;elts;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (value[<span class="Constant">1</span>].data[<span class="Constant">0</span>] == <span class="Constant">'-'</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; n = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; minus = <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> <span class="Statement">if</span> (value[<span class="Constant">1</span>].data[<span class="Constant">0</span>] == <span class="Constant">'+'</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; n = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; minus = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; n = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; minus = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;priority = <a href="ngx_string.c.html#L898" title="core/ngx_string.c:898">ngx_atoi</a>(&amp;value[<span class="Constant">1</span>].data[n], value[<span class="Constant">1</span>].len - n);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;priority == <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">&quot;invalid number&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (minus) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;priority = -ccf-&gt;priority;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<br/></li>
<li><a id="L1246">&#x200c;</a><span class="linkable">ngx_set_cpu_affinity</span>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf)<br/></li>
<li>{<br/></li>
<li><span class="PreProc">#if (<a href="../os/unix/ngx_setaffinity.h.html#L12" title="os/unix/ngx_setaffinity.h:12">NGX_HAVE_CPU_AFFINITY</a>)<br/></li>
<li></span>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf = conf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; u_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ch;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">uint64_t</span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *mask;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *value;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp; &nbsp; &nbsp; &nbsp; i, n;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;cpu_affinity) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">&quot;is duplicate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; mask = <a href="ngx_palloc.c.html#L120" title="core/ngx_palloc.c:120">ngx_palloc</a>(cf-&gt;pool, (cf-&gt;args-&gt;nelts - <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">uint64_t</span>));<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (mask == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;cpu_affinity_n = cf-&gt;args-&gt;nelts - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; ccf-&gt;cpu_affinity = mask;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; value = cf-&gt;args-&gt;elts;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (n = <span class="Constant">1</span>; n &lt; cf-&gt;args-&gt;nelts; n++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (value[n].len &gt; <span class="Constant">64</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cf, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">worker_cpu_affinity</span><span class="Special">\&quot;</span><span class="Constant"> supports up to 64 CPUs only&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; mask[n - <span class="Constant">1</span>] = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; value[n].len; i++) {<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ch = value[n].data[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ch == <span class="Constant">' '</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mask[n - <span class="Constant">1</span>] &lt;&lt;= <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ch == <span class="Constant">'0'</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ch == <span class="Constant">'1'</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mask[n - <span class="Constant">1</span>] |= <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L17" title="core/ngx_log.h:17">NGX_LOG_EMERG</a>, cf, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;invalid character </span><span class="Special">\&quot;%c\&quot;</span><span class="Constant"> in </span><span class="Special">\&quot;</span><span class="Constant">worker_cpu_affinity</span><span class="Special">\&quot;</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ch);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L65" title="core/ngx_conf_file.h:65">NGX_CONF_ERROR</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="ngx_conf_file.c.html#L909" title="core/ngx_conf_file.c:909">ngx_conf_log_error</a>(<a href="ngx_log.h.html#L21" title="core/ngx_log.h:21">NGX_LOG_WARN</a>, cf, <span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">worker_cpu_affinity</span><span class="Special">\&quot;</span><span class="Constant"> is not supported &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;on this platform, ignored&quot;</span>);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">uint64_t<br/></li>
<li><a id="L1318">&#x200c;</a></span><span class="linkable">ngx_get_cpu_affinity</span>(<a href="ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a> n)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf = (<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a> *) <a href="ngx_conf_file.h.html#L217" title="core/ngx_conf_file.h:217">ngx_get_conf</a>(<a href="ngx_cycle.c.html#L20" title="core/ngx_cycle.c:20">ngx_cycle</a>-&gt;conf_ctx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="#L171" title="core/nginx.c:171">ngx_core_module</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;cpu_affinity == <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;cpu_affinity_n &gt; n) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> ccf-&gt;cpu_affinity[n];<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> ccf-&gt;cpu_affinity[ccf-&gt;cpu_affinity_n - <span class="Constant">1</span>];<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">char</span> *<br/></li>
<li><a id="L1338">&#x200c;</a><span class="linkable">ngx_set_worker_processes</span>(<a href="ngx_core.h.html#L13" title="core/ngx_core.h:13">ngx_conf_t</a> *cf, <a href="ngx_core.h.html#L19" title="core/ngx_core.h:19">ngx_command_t</a> *cmd, <span class="Type">void</span> *conf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *value;<br/></li>
<li>&nbsp; &nbsp; <a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a>&nbsp; *ccf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf = (<a href="ngx_cycle.h.html#L111" title="core/ngx_cycle.h:111">ngx_core_conf_t</a> *) conf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;worker_processes != <a href="ngx_conf_file.h.html#L57" title="core/ngx_conf_file.h:57">NGX_CONF_UNSET</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">&quot;is duplicate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; value = (<a href="ngx_string.h.html#L19" title="core/ngx_string.h:19">ngx_str_t</a> *) cf-&gt;args-&gt;elts;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="ngx_string.h.html#L57" title="core/ngx_string.h:57">ngx_strcmp</a>(value[<span class="Constant">1</span>].data, <span class="Constant">&quot;auto&quot;</span>) == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ccf-&gt;worker_processes = <a href="../os/unix/ngx_posix_init.c.html#L13" title="os/unix/ngx_posix_init.c:13">ngx_ncpu</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ccf-&gt;worker_processes = <a href="ngx_string.c.html#L898" title="core/ngx_string.c:898">ngx_atoi</a>(value[<span class="Constant">1</span>].data, value[<span class="Constant">1</span>].len);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (ccf-&gt;worker_processes == <a href="ngx_core.h.html#L30" title="core/ngx_core.h:30">NGX_ERROR</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">&quot;invalid value&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="ngx_conf_file.h.html#L64" title="core/ngx_conf_file.h:64">NGX_CONF_OK</a>;<br/></li>
<li>}<br/></li>
</ol></code>
 </body>
</html>
