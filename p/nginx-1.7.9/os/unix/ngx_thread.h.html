<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>os/unix/ngx_thread.h - src</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
  <h3>os/unix/ngx_thread.h - src</h3>
   <a href="../index.html"> Table of Contents </a>
 <h4>Data types defined</h4>
 <ul>
<li><a href="#L58">ngx_cond_t</a></li>
<li><a href="#L53">ngx_mutex_t</a></li>
<li><a href="#L83">ngx_thread_t</a></li>
<li><a href="#L94">ngx_thread_value_t</a></li>
<li><a href="#L27">ngx_tid_t</a></li>
<li><a href="#L39">ngx_tls_key_t</a></li>
</ul>
 <h4>Macros defined</h4>
 <ul>
<li><a href="#L17">NGX_MAX_THREADS</a></li>
<li><a href="#L48">NGX_MUTEX_LIGHT</a></li>
<li><a href="#L86">NGX_THREAD_BUSY</a></li>
<li><a href="#L88">NGX_THREAD_DONE</a></li>
<li><a href="#L87">NGX_THREAD_EXIT</a></li>
<li><a href="#L85">NGX_THREAD_FREE</a></li>
<li><a href="#L33">NGX_TID_T_FMT</a></li>
<li><a href="#L35">NGX_TID_T_FMT</a></li>
<li><a href="#L115">NGX_TID_T_FMT</a></li>
<li><a href="#L9">_NGX_THREAD_H_INCLUDED_</a></li>
<li><a href="#L121">ngx_cond_signal</a></li>
<li><a href="#L30">ngx_log_tid</a></li>
<li><a href="#L114">ngx_log_tid</a></li>
<li><a href="#L118">ngx_mutex_lock</a></li>
<li><a href="#L117">ngx_mutex_trylock</a></li>
<li><a href="#L119">ngx_mutex_unlock</a></li>
<li><a href="#L65">ngx_setthrtitle</a></li>
<li><a href="#L45">ngx_thread_get_tls</a></li>
<li><a href="#L63">ngx_thread_join</a></li>
<li><a href="#L41">ngx_thread_key_create</a></li>
<li><a href="#L42">ngx_thread_key_create_n</a></li>
<li><a href="#L123">ngx_thread_main</a></li>
<li><a href="#L29">ngx_thread_self</a></li>
<li><a href="#L43">ngx_thread_set_tls</a></li>
<li><a href="#L44">ngx_thread_set_tls_n</a></li>
<li><a href="#L60">ngx_thread_sigmask</a></li>
<li><a href="#L61">ngx_thread_sigmask_n</a></li>
<li><a href="#L76">ngx_thread_volatile</a></li>
<li><a href="#L112">ngx_thread_volatile</a></li>
</ul>
 <h4>Source code</h4>

  <code><ol><li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Copyright (C) Igor Sysoev<br/></li>
<li></span><span class="Comment"> * Copyright (C) Nginx, Inc.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#ifndef <a href="#L9" title="os/unix/ngx_thread.h:9">_NGX_THREAD_H_INCLUDED_</a><br/></li>
<li><a id="L9">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">_NGX_THREAD_H_INCLUDED_</span><br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;ngx_config.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;ngx_core.h&gt;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if (NGX_THREADS)<br/></li>
<li></span><br/></li>
<li><a id="L17">&#x200c;</a><span class="PreProc">#define <span class="linkable">NGX_MAX_THREADS</span>&nbsp; &nbsp; &nbsp; </span><span class="Constant">128<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if (NGX_USE_RFORK)<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;ngx_freebsd_rfork_thread.h&gt;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#else</span> <span class="Comment">/* use pthreads */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;pthread.h&gt;<br/></li>
<li></span><br/></li>
<li><a id="L27">&#x200c;</a><span class="Type">typedef</span> pthread_t&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="linkable">ngx_tid_t</span>;<br/></li>
<li><br/></li>
<li><a id="L29">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_self</span>()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pthread_self()<br/></li>
<li><a id="L30">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_log_tid</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Type">int</span><span class="PreProc">) <a href="#L29" title="os/unix/ngx_thread.h:29">ngx_thread_self</a>()<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if (NGX_FREEBSD) &amp;&amp; !(NGX_LINUXTHREADS)<br/></li>
<li><a id="L33">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NGX_TID_T_FMT</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;</span><span class="Special">%p</span><span class="Constant">&quot;<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L35">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NGX_TID_T_FMT</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;</span><span class="Special">%d</span><span class="Constant">&quot;<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L39">&#x200c;</a><span class="Type">typedef</span> pthread_key_t&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="linkable">ngx_tls_key_t</span>;<br/></li>
<li><br/></li>
<li><a id="L41">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_key_create</span>(key)&nbsp;&nbsp; pthread_key_create(key, </span><span class="Constant">NULL</span><span class="PreProc">)<br/></li>
<li><a id="L42">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_thread_key_create_n</span>&nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;pthread_key_create()&quot;<br/></li>
<li><a id="L43">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_thread_set_tls</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; pthread_setspecific<br/></li>
<li><a id="L44">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_thread_set_tls_n</span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">&quot;pthread_setspecific()&quot;<br/></li>
<li><a id="L45">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_thread_get_tls</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; pthread_getspecific<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L48">&#x200c;</a><span class="PreProc">#define <span class="linkable">NGX_MUTEX_LIGHT</span>&nbsp; &nbsp;&nbsp; </span><span class="Constant">0<br/></li>
<li></span><br/></li>
<li><span class="Type">typedef</span> <span class="Type">struct</span> {<br/></li>
<li>&nbsp; &nbsp; pthread_mutex_t&nbsp;&nbsp; mutex;<br/></li>
<li>&nbsp; &nbsp; <a href="../../core/ngx_core.h.html#L17" title="core/ngx_core.h:17">ngx_log_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *log;<br/></li>
<li><a id="L53">&#x200c;</a>} <span class="linkable">ngx_mutex_t</span>;<br/></li>
<li><br/></li>
<li><span class="Type">typedef</span> <span class="Type">struct</span> {<br/></li>
<li>&nbsp; &nbsp; pthread_cond_t&nbsp; &nbsp; cond;<br/></li>
<li>&nbsp; &nbsp; <a href="../../core/ngx_core.h.html#L17" title="core/ngx_core.h:17">ngx_log_t</a>&nbsp; &nbsp; &nbsp; &nbsp; *log;<br/></li>
<li><a id="L58">&#x200c;</a>} <span class="linkable">ngx_cond_t</span>;<br/></li>
<li><br/></li>
<li><a id="L60">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_sigmask</span>&nbsp; &nbsp;&nbsp; pthread_sigmask<br/></li>
<li><a id="L61">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_thread_sigmask_n</span>&nbsp; </span><span class="Constant">&quot;pthread_sigmask()&quot;<br/></li>
<li></span><br/></li>
<li><a id="L63">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_join</span>(t, p)&nbsp; pthread_join(t, p)<br/></li>
<li></span><br/></li>
<li><a id="L65">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_setthrtitle</span>(n)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><a href="../../core/ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="ngx_pthread_thread.c.html#L143" title="os/unix/ngx_pthread_thread.c:143">ngx_mutex_trylock</a>(<a href="#L53" title="os/unix/ngx_thread.h:53">ngx_mutex_t</a> *m);<br/></li>
<li><span class="Type">void</span> <a href="ngx_pthread_thread.c.html#L118" title="os/unix/ngx_pthread_thread.c:118">ngx_mutex_lock</a>(<a href="#L53" title="os/unix/ngx_thread.h:53">ngx_mutex_t</a> *m);<br/></li>
<li><span class="Type">void</span> <a href="ngx_pthread_thread.c.html#L172" title="os/unix/ngx_pthread_thread.c:172">ngx_mutex_unlock</a>(<a href="#L53" title="os/unix/ngx_thread.h:53">ngx_mutex_t</a> *m);<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L76">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_volatile</span>&nbsp;&nbsp; </span><span class="Type">volatile<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Type">typedef</span> <span class="Type">struct</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="#L27" title="os/unix/ngx_thread.h:27">ngx_tid_t</a>&nbsp; &nbsp; tid;<br/></li>
<li>&nbsp; &nbsp; <a href="#L58" title="os/unix/ngx_thread.h:58">ngx_cond_t</a>&nbsp; *cv;<br/></li>
<li>&nbsp; &nbsp; <a href="../../core/ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a>&nbsp;&nbsp; state;<br/></li>
<li><a id="L83">&#x200c;</a>} <span class="linkable">ngx_thread_t</span>;<br/></li>
<li><br/></li>
<li><a id="L85">&#x200c;</a><span class="PreProc">#define <span class="linkable">NGX_THREAD_FREE</span>&nbsp;&nbsp; </span><span class="Constant">1<br/></li>
<li><a id="L86">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NGX_THREAD_BUSY</span>&nbsp;&nbsp; </span><span class="Constant">2<br/></li>
<li><a id="L87">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NGX_THREAD_EXIT</span>&nbsp;&nbsp; </span><span class="Constant">3<br/></li>
<li><a id="L88">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NGX_THREAD_DONE</span>&nbsp;&nbsp; </span><span class="Constant">4<br/></li>
<li></span><br/></li>
<li><span class="Type">extern</span> <a href="../../core/ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="ngx_process_cycle.c.html#L61" title="os/unix/ngx_process_cycle.c:61">ngx_threads_n</a>;<br/></li>
<li><span class="Type">extern</span> <span class="Type">volatile</span> <a href="#L83" title="os/unix/ngx_thread.h:83">ngx_thread_t</a>&nbsp; <a href="ngx_process_cycle.c.html#L60" title="os/unix/ngx_process_cycle.c:60">ngx_threads</a>[<a href="#L17" title="os/unix/ngx_thread.h:17">NGX_MAX_THREADS</a>];<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L94">&#x200c;</a><span class="Type">typedef</span> <span class="Type">void</span> *&nbsp; <span class="linkable">ngx_thread_value_t</span>;<br/></li>
<li><br/></li>
<li><a href="../../core/ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="ngx_pthread_thread.c.html#L48" title="os/unix/ngx_pthread_thread.c:48">ngx_init_threads</a>(<span class="Type">int</span> n, <span class="Type">size_t</span> size, <a href="../../core/ngx_core.h.html#L14" title="core/ngx_core.h:14">ngx_cycle_t</a> *cycle);<br/></li>
<li><a href="ngx_errno.h.html#L16" title="os/unix/ngx_errno.h:16">ngx_err_t</a> <a href="ngx_pthread_thread.c.html#L20" title="os/unix/ngx_pthread_thread.c:20">ngx_create_thread</a>(<a href="#L27" title="os/unix/ngx_thread.h:27">ngx_tid_t</a> *tid,<br/></li>
<li>&nbsp; &nbsp; <a href="#L94" title="os/unix/ngx_thread.h:94">ngx_thread_value_t</a> (*func)(<span class="Type">void</span> *arg), <span class="Type">void</span> *arg, <a href="../../core/ngx_core.h.html#L17" title="core/ngx_core.h:17">ngx_log_t</a> *log);<br/></li>
<li><br/></li>
<li><a href="#L53" title="os/unix/ngx_thread.h:53">ngx_mutex_t</a> *<a href="ngx_pthread_thread.c.html#L77" title="os/unix/ngx_pthread_thread.c:77">ngx_mutex_init</a>(<a href="../../core/ngx_core.h.html#L17" title="core/ngx_core.h:17">ngx_log_t</a> *log, <a href="../../core/ngx_config.h.html#L79" title="core/ngx_config.h:79">ngx_uint_t</a> flags);<br/></li>
<li><span class="Type">void</span> <a href="ngx_pthread_thread.c.html#L102" title="os/unix/ngx_pthread_thread.c:102">ngx_mutex_destroy</a>(<a href="#L53" title="os/unix/ngx_thread.h:53">ngx_mutex_t</a> *m);<br/></li>
<li><br/></li>
<li><br/></li>
<li><a href="#L58" title="os/unix/ngx_thread.h:58">ngx_cond_t</a> *<a href="ngx_pthread_thread.c.html#L197" title="os/unix/ngx_pthread_thread.c:197">ngx_cond_init</a>(<a href="../../core/ngx_core.h.html#L17" title="core/ngx_core.h:17">ngx_log_t</a> *log);<br/></li>
<li><span class="Type">void</span> <a href="ngx_pthread_thread.c.html#L222" title="os/unix/ngx_pthread_thread.c:222">ngx_cond_destroy</a>(<a href="#L58" title="os/unix/ngx_thread.h:58">ngx_cond_t</a> *cv);<br/></li>
<li><a href="../../core/ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="ngx_pthread_thread.c.html#L238" title="os/unix/ngx_pthread_thread.c:238">ngx_cond_wait</a>(<a href="#L58" title="os/unix/ngx_thread.h:58">ngx_cond_t</a> *cv, <a href="#L53" title="os/unix/ngx_thread.h:53">ngx_mutex_t</a> *m);<br/></li>
<li><a href="../../core/ngx_config.h.html#L78" title="core/ngx_config.h:78">ngx_int_t</a> <a href="ngx_pthread_thread.c.html#L261" title="os/unix/ngx_pthread_thread.c:261">ngx_cond_signal</a>(<a href="#L58" title="os/unix/ngx_thread.h:58">ngx_cond_t</a> *cv);<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="PreProc">#else</span> <span class="Comment">/* !NGX_THREADS */<br/></li>
<li></span><br/></li>
<li><a id="L112">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_volatile</span><br/></li>
<li></span><br/></li>
<li><a id="L114">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_log_tid</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">0<br/></li>
<li><a id="L115">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NGX_TID_T_FMT</span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">&quot;</span><span class="Special">%d</span><span class="Constant">&quot;<br/></li>
<li></span><br/></li>
<li><a id="L117">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_mutex_trylock</span>(m)&nbsp; <a href="../../core/ngx_core.h.html#L29" title="core/ngx_core.h:29">NGX_OK</a><br/></li>
<li><a id="L118">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_mutex_lock</span>(m)<br/></li>
<li><a id="L119">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ngx_mutex_unlock</span>(m)<br/></li>
<li></span><br/></li>
<li><a id="L121">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_cond_signal</span>(cv)<br/></li>
<li></span><br/></li>
<li><a id="L123">&#x200c;</a><span class="PreProc">#define <span class="linkable">ngx_thread_main</span>()&nbsp; &nbsp;&nbsp; </span><span class="Constant">1<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#endif</span> <span class="Comment">/* <a href="#L9" title="os/unix/ngx_thread.h:9">_NGX_THREAD_H_INCLUDED_</a> */<br/></li>
</ol></span></code>
 </body>
</html>
