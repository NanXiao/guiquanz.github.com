<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>loslib.c - src</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
  <h3>loslib.c - src</h3>
   <a href="../index.html"> Table of Contents </a>
 <h4>Global variables defined</h4>
 <ul>
<li><a href="#L333">syslib</a></li>
</ul>
 <h4>Functions defined</h4>
 <ul>
<li><a href="#L202">checkoption</a></li>
<li><a href="#L180">getboolfield</a></li>
<li><a href="#L188">getfield</a></li>
<li><a href="#L352">luaopen_os</a></li>
<li><a href="#L154">os_clock</a></li>
<li><a href="#L226">os_date</a></li>
<li><a href="#L299">os_difftime</a></li>
<li><a href="#L112">os_execute</a></li>
<li><a href="#L320">os_exit</a></li>
<li><a href="#L148">os_getenv</a></li>
<li><a href="#L124">os_remove</a></li>
<li><a href="#L130">os_rename</a></li>
<li><a href="#L308">os_setlocale</a></li>
<li><a href="#L272">os_time</a></li>
<li><a href="#L137">os_tmpname</a></li>
<li><a href="#L173">setboolfield</a></li>
<li><a href="#L168">setfield</a></li>
</ul>
 <h4>Macros defined</h4>
 <ul>
<li><a href="#L8">LUA_LIB</a></li>
<li><a href="#L31">LUA_STRFTIMEOPTIONS</a></li>
<li><a href="#L33">LUA_STRFTIMEOPTIONS</a></li>
<li><a href="#L65">LUA_TMPNAMBUFSIZE</a></li>
<li><a href="#L80">LUA_TMPNAMBUFSIZE</a></li>
<li><a href="#L68">LUA_TMPNAMTEMPLATE</a></li>
<li><a href="#L49">l_checktime</a></li>
<li><a href="#L97">l_gmtime</a></li>
<li><a href="#L103">l_gmtime</a></li>
<li><a href="#L98">l_localtime</a></li>
<li><a href="#L104">l_localtime</a></li>
<li><a href="#L48">l_pushtime</a></li>
<li><a href="#L47">l_timet</a></li>
<li><a href="#L7">loslib_c</a></li>
<li><a href="#L71">lua_tmpnam</a></li>
<li><a href="#L81">lua_tmpnam</a></li>
</ul>
 <h4>Source code</h4>

  <code><ol><li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** $Id: loslib.c,v 1.54 2014/12/26 14:46:07 roberto Exp $<br/></li>
<li></span><span class="Comment">** Standard Operating System library<br/></li>
<li></span><span class="Comment">** See Copyright Notice in lua.h<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><a id="L7">&#x200c;</a><span class="PreProc">#define <span class="linkable">loslib_c</span><br/></li>
<li><a id="L8">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LUA_LIB</span><br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lprefix.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;errno.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;locale.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;stdlib.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;string.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;time.h&gt;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lua.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lauxlib.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;lualib.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#if !defined(<a href="#L31" title="loslib.c:31">LUA_STRFTIMEOPTIONS</a>)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** list of valid conversion specifiers for the 'strftime' function<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if defined(<a href="luaconf.h.html#L57" title="luaconf.h:57">LUA_USE_C89</a>)<br/></li>
<li><a id="L31">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LUA_STRFTIMEOPTIONS</span>&nbsp; &nbsp; &nbsp; &nbsp; { </span><span class="Constant">&quot;aAbBcdHIjmMpSUwWxXyYz%&quot;</span><span class="PreProc">, </span><span class="Constant">&quot;&quot;</span><span class="PreProc"> }<br/></li>
<li></span><span class="PreProc">#else</span>&nbsp; <span class="Comment">/* C99 specification */<br/></li>
<li><a id="L33">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LUA_STRFTIMEOPTIONS</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; { </span><span class="Constant">&quot;aAbBcCdDeFgGhHIjmMnprRStTuUVwWxXyYzZ%&quot;</span><span class="PreProc">, </span><span class="Constant">&quot;&quot;</span><span class="PreProc">, \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;E&quot;</span><span class="PreProc">, </span><span class="Constant">&quot;cCxXyY&quot;</span><span class="PreProc">,&nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;O&quot;</span><span class="PreProc">, </span><span class="Constant">&quot;deHImMSuUVwWy&quot;</span><span class="PreProc"> }<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="PreProc">#if !defined(l_time_t)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** type to represent time_t in Lua<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L47">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_timet</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a><br/></li>
<li><a id="L48">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_pushtime</span>(L,t)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L,(<a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a>)(t))<br/></li>
<li><a id="L49">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_checktime</span>(L,a)&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Type">time_t</span><span class="PreProc">)<a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L,a))<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="PreProc">#if !defined(<a href="#L71" title="loslib.c:71">lua_tmpnam</a>)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** By default, Lua uses tmpnam except when POSIX is available, where it<br/></li>
<li></span><span class="Comment">** uses mkstemp.<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if defined(<a href="luaconf.h.html#L62" title="luaconf.h:62">LUA_USE_POSIX</a>)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;unistd.h&gt;<br/></li>
<li></span><br/></li>
<li><a id="L65">&#x200c;</a><span class="PreProc">#define <span class="linkable">LUA_TMPNAMBUFSIZE</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">32<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if !defined(<a href="#L68" title="loslib.c:68">LUA_TMPNAMTEMPLATE</a>)<br/></li>
<li><a id="L68">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LUA_TMPNAMTEMPLATE</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;/tmp/lua_XXXXXX&quot;<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><a id="L71">&#x200c;</a><span class="PreProc">#define <span class="linkable">lua_tmpnam</span>(b,e) { \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; strcpy(b, <a href="#L68" title="loslib.c:68">LUA_TMPNAMTEMPLATE</a>); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; e = mkstemp(b); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="PreProc"> (e != -</span><span class="Constant">1</span><span class="PreProc">) close(e); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; e = (e == -</span><span class="Constant">1</span><span class="PreProc">); }<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#else</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* }{ */<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* ISO C definitions */<br/></li>
<li><a id="L80">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LUA_TMPNAMBUFSIZE</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">L_tmpnam<br/></li>
<li><a id="L81">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">lua_tmpnam</span>(b,e)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { e = (tmpnam(b) == </span><span class="Constant">NULL</span><span class="PreProc">); }<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="PreProc">#if !defined(<a href="#L97" title="loslib.c:97">l_gmtime</a>)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** By default, Lua uses gmtime/localtime, except when POSIX is available,<br/></li>
<li></span><span class="Comment">** where it uses gmtime_r/localtime_r<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if defined(<a href="luaconf.h.html#L62" title="luaconf.h:62">LUA_USE_POSIX</a>)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><br/></li>
<li><a id="L97">&#x200c;</a><span class="PreProc">#define <span class="linkable">l_gmtime</span>(t,r)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gmtime_r(t,r)<br/></li>
<li><a id="L98">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_localtime</span>(t,r)&nbsp; &nbsp; &nbsp; &nbsp; localtime_r(t,r)<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#else</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* }{ */<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* ISO C definitions */<br/></li>
<li><a id="L103">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_gmtime</span>(t,r)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Type">void</span><span class="PreProc">)(r)-&gt;tm_sec, gmtime(t))<br/></li>
<li><a id="L104">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_localtime</span>(t,r)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Type">void</span><span class="PreProc">)(r)-&gt;tm_sec, localtime(t))<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L112">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_execute</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">const</span> <span class="Type">char</span> *cmd = <a href="lauxlib.h.html#L117" title="lauxlib.h:117">luaL_optstring</a>(L, <span class="Constant">1</span>, <span class="Constant">NULL</span>);<br/></li>
<li>&nbsp; <span class="Type">int</span> stat = system(cmd);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (cmd != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="lauxlib.c.html#L263" title="lauxlib.c:263">luaL_execresult</a>(L, stat);<br/></li>
<li>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L550" title="lapi.c:550">lua_pushboolean</a>(L, stat);&nbsp; <span class="Comment">/* true if there is a shell */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L124">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_remove</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">const</span> <span class="Type">char</span> *filename = <a href="lauxlib.h.html#L116" title="lauxlib.h:116">luaL_checkstring</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <a href="lauxlib.c.html#L223" title="lauxlib.c:223">luaL_fileresult</a>(L, remove(filename) == <span class="Constant">0</span>, filename);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L130">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_rename</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">const</span> <span class="Type">char</span> *fromname = <a href="lauxlib.h.html#L116" title="lauxlib.h:116">luaL_checkstring</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <span class="Type">const</span> <span class="Type">char</span> *toname = <a href="lauxlib.h.html#L116" title="lauxlib.h:116">luaL_checkstring</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <a href="lauxlib.c.html#L223" title="lauxlib.c:223">luaL_fileresult</a>(L, rename(fromname, toname) == <span class="Constant">0</span>, <span class="Constant">NULL</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L137">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_tmpname</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">char</span> buff[<a href="#L65" title="loslib.c:65">LUA_TMPNAMBUFSIZE</a>];<br/></li>
<li>&nbsp; <span class="Type">int</span> err;<br/></li>
<li>&nbsp; <a href="#L71" title="loslib.c:71">lua_tmpnam</a>(buff, err);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (err)<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="lauxlib.c.html#L212" title="lauxlib.c:212">luaL_error</a>(L, <span class="Constant">&quot;unable to generate a unique filename&quot;</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L484" title="lapi.c:484">lua_pushstring</a>(L, buff);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L148">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_getenv</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L484" title="lapi.c:484">lua_pushstring</a>(L, getenv(<a href="lauxlib.h.html#L116" title="lauxlib.h:116">luaL_checkstring</a>(L, <span class="Constant">1</span>)));&nbsp; <span class="Comment">/* if NULL push nil */<br/></li>
<li></span>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L154">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_clock</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, ((<a href="lua.h.html#L87" title="lua.h:87">lua_Number</a>)clock())/(<a href="lua.h.html#L87" title="lua.h:87">lua_Number</a>)<span class="Constant">CLOCKS_PER_SEC</span>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** {======================================================<br/></li>
<li></span><span class="Comment">** Time/Date operations<br/></li>
<li></span><span class="Comment">** { year=%Y, month=%m, day=%d, hour=%H, min=%M, sec=%<a href="luac.c.html#L393" title="luac.c:393">S</a>,<br/></li>
<li></span><span class="Comment">**&nbsp;&nbsp; wday=%w+1, yday=%j, isdst=? }<br/></li>
<li></span><span class="Comment">** =======================================================<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><a id="L168">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">setfield</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L, <span class="Type">const</span> <span class="Type">char</span> *key, <span class="Type">int</span> value) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, value);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L745" title="lapi.c:745">lua_setfield</a>(L, -<span class="Constant">2</span>, key);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L173">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">setboolfield</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L, <span class="Type">const</span> <span class="Type">char</span> *key, <span class="Type">int</span> value) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (value &lt; <span class="Constant">0</span>)&nbsp; <span class="Comment">/* undefined? */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">return</span>;&nbsp; <span class="Comment">/* does not set <a href="lparser.c.html#L696" title="lparser.c:696">field</a> */<br/></li>
<li></span>&nbsp; <a href="lapi.c.html#L550" title="lapi.c:550">lua_pushboolean</a>(L, value);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L745" title="lapi.c:745">lua_setfield</a>(L, -<span class="Constant">2</span>, key);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L180">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">getboolfield</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L, <span class="Type">const</span> <span class="Type">char</span> *key) {<br/></li>
<li>&nbsp; <span class="Type">int</span> res;<br/></li>
<li>&nbsp; res = (<a href="lapi.c.html#L603" title="lapi.c:603">lua_getfield</a>(L, -<span class="Constant">1</span>, key) == <a href="lua.h.html#L62" title="lua.h:62">LUA_TNIL</a>) ? -<span class="Constant">1</span> : <a href="lapi.c.html#L366" title="lapi.c:366">lua_toboolean</a>(L, -<span class="Constant">1</span>);<br/></li>
<li>&nbsp; <a href="lua.h.html#L342" title="lua.h:342">lua_pop</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> res;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L188">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">getfield</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L, <span class="Type">const</span> <span class="Type">char</span> *key, <span class="Type">int</span> d) {<br/></li>
<li>&nbsp; <span class="Type">int</span> res, isnum;<br/></li>
<li>&nbsp; <a href="lapi.c.html#L603" title="lapi.c:603">lua_getfield</a>(L, -<span class="Constant">1</span>, key);<br/></li>
<li>&nbsp; res = (<span class="Type">int</span>)<a href="lapi.c.html#L355" title="lapi.c:355">lua_tointegerx</a>(L, -<span class="Constant">1</span>, &amp;isnum);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (!isnum) {<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (d &lt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="lauxlib.c.html#L212" title="lauxlib.c:212">luaL_error</a>(L, <span class="Constant">&quot;<a href="lparser.c.html#L696" title="lparser.c:696">field</a> '</span><span class="Special">%s</span><span class="Constant">' missing in date table&quot;</span>, key);<br/></li>
<li>&nbsp; &nbsp; res = d;<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <a href="lua.h.html#L342" title="lua.h:342">lua_pop</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> res;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L202">&#x200c;</a><span class="Type">static</span> <span class="Type">const</span> <span class="Type">char</span> *<span class="linkable">checkoption</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L, <span class="Type">const</span> <span class="Type">char</span> *conv, <span class="Type">char</span> *buff) {<br/></li>
<li>&nbsp; <span class="Type">static</span> <span class="Type">const</span> <span class="Type">char</span> *<span class="Type">const</span> options[] = <a href="#L31" title="loslib.c:31">LUA_STRFTIMEOPTIONS</a>;<br/></li>
<li>&nbsp; <span class="Type">unsigned</span> <span class="Type">int</span> i;<br/></li>
<li>&nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <span class="Statement">sizeof</span>(options)/<span class="Statement">sizeof</span>(options[<span class="Constant">0</span>]); i += <span class="Constant">2</span>) {<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (*conv != <span class="Special">'\0'</span> &amp;&amp; strchr(options[i], *conv) != <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; buff[<span class="Constant">1</span>] = *conv;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*options[i + <span class="Constant">1</span>] == <span class="Special">'\0'</span>) {&nbsp; <span class="Comment">/* one-char conversion specifier? */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; buff[<span class="Constant">2</span>] = <span class="Special">'\0'</span>;&nbsp; <span class="Comment">/* end buffer */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> conv + <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (*(conv + <span class="Constant">1</span>) != <span class="Special">'\0'</span> &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; strchr(options[i + <span class="Constant">1</span>], *(conv + <span class="Constant">1</span>)) != <span class="Constant">NULL</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; buff[<span class="Constant">2</span>] = *(conv + <span class="Constant">1</span>);&nbsp; <span class="Comment">/* valid two-char conversion specifier */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; buff[<span class="Constant">3</span>] = <span class="Special">'\0'</span>;&nbsp; <span class="Comment">/* end buffer */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> conv + <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <a href="lauxlib.c.html#L162" title="lauxlib.c:162">luaL_argerror</a>(L, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L513" title="lapi.c:513">lua_pushfstring</a>(L, <span class="Constant">&quot;invalid conversion specifier '</span><span class="Special">%%%s</span><span class="Constant">'&quot;</span>, conv));<br/></li>
<li>&nbsp; <span class="Statement">return</span> conv;&nbsp; <span class="Comment">/* to avoid warnings */<br/></li>
<li></span>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L226">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_date</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">const</span> <span class="Type">char</span> *s = <a href="lauxlib.h.html#L117" title="lauxlib.h:117">luaL_optstring</a>(L, <span class="Constant">1</span>, <span class="Constant">&quot;</span><span class="Special">%c</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; <span class="Type">time_t</span> t = <a href="lauxlib.h.html#L129" title="lauxlib.h:129">luaL_opt</a>(L, <a href="#L49" title="loslib.c:49">l_checktime</a>, <span class="Constant">2</span>, time(<span class="Constant">NULL</span>));<br/></li>
<li>&nbsp; <span class="Type">struct</span> tm tmr, *stm;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (*s == <span class="Constant">'!'</span>) {&nbsp; <span class="Comment">/* UTC? */<br/></li>
<li></span>&nbsp; &nbsp; stm = <a href="#L97" title="loslib.c:97">l_gmtime</a>(&amp;t, &amp;tmr);<br/></li>
<li>&nbsp; &nbsp; s++;&nbsp; <span class="Comment">/* skip '!' */<br/></li>
<li></span>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; stm = <a href="#L98" title="loslib.c:98">l_localtime</a>(&amp;t, &amp;tmr);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (stm == <span class="Constant">NULL</span>)&nbsp; <span class="Comment">/* invalid date? */<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L448" title="lapi.c:448">lua_pushnil</a>(L);<br/></li>
<li>&nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(s, <span class="Constant">&quot;*t&quot;</span>) == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L664" title="lapi.c:664">lua_createtable</a>(L, <span class="Constant">0</span>, <span class="Constant">9</span>);&nbsp; <span class="Comment">/* 9 = number of fields */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;sec&quot;</span>, stm-&gt;tm_sec);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;min&quot;</span>, stm-&gt;tm_min);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;hour&quot;</span>, stm-&gt;tm_hour);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;day&quot;</span>, stm-&gt;tm_mday);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;month&quot;</span>, stm-&gt;tm_mon+<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;year&quot;</span>, stm-&gt;tm_year+<span class="Constant">1900</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;wday&quot;</span>, stm-&gt;tm_wday+<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L168" title="loslib.c:168">setfield</a>(L, <span class="Constant">&quot;yday&quot;</span>, stm-&gt;tm_yday+<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L173" title="loslib.c:173">setboolfield</a>(L, <span class="Constant">&quot;isdst&quot;</span>, stm-&gt;tm_isdst);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span> cc[<span class="Constant">4</span>];<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.h.html#L140" title="lauxlib.h:140">luaL_Buffer</a> b;<br/></li>
<li>&nbsp; &nbsp; cc[<span class="Constant">0</span>] = <span class="Constant">'%'</span>;<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.c.html#L507" title="lauxlib.c:507">luaL_buffinit</a>(L, &amp;b);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (*s) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*s != <span class="Constant">'%'</span>)&nbsp; <span class="Comment">/* no conversion specifier? */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="lauxlib.h.html#L149" title="lauxlib.h:149">luaL_addchar</a>(&amp;b, *s++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">size_t</span> reslen;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span> buff[<span class="Constant">200</span>];&nbsp; <span class="Comment">/* should be big enough for any conversion result */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; s = <a href="#L202" title="loslib.c:202">checkoption</a>(L, s + <span class="Constant">1</span>, cc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; reslen = strftime(buff, <span class="Statement">sizeof</span>(buff), cc, stm);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="lauxlib.c.html#L470" title="lauxlib.c:470">luaL_addlstring</a>(&amp;b, buff, reslen);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.c.html#L482" title="lauxlib.c:482">luaL_pushresult</a>(&amp;b);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L272">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_time</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">time_t</span> t;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lua.h.html#L357" title="lua.h:357">lua_isnoneornil</a>(L, <span class="Constant">1</span>))&nbsp; <span class="Comment">/* called without args? */<br/></li>
<li></span>&nbsp; &nbsp; t = time(<span class="Constant">NULL</span>);&nbsp; <span class="Comment">/* get current time */<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> tm ts;<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.c.html#L362" title="lauxlib.c:362">luaL_checktype</a>(L, <span class="Constant">1</span>, <a href="lua.h.html#L67" title="lua.h:67">LUA_TTABLE</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L171" title="lapi.c:171">lua_settop</a>(L, <span class="Constant">1</span>);&nbsp; <span class="Comment">/* make sure table is at the top */<br/></li>
<li></span>&nbsp; &nbsp; ts.tm_sec = <a href="#L188" title="loslib.c:188">getfield</a>(L, <span class="Constant">&quot;sec&quot;</span>, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; ts.tm_min = <a href="#L188" title="loslib.c:188">getfield</a>(L, <span class="Constant">&quot;min&quot;</span>, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; ts.tm_hour = <a href="#L188" title="loslib.c:188">getfield</a>(L, <span class="Constant">&quot;hour&quot;</span>, <span class="Constant">12</span>);<br/></li>
<li>&nbsp; &nbsp; ts.tm_mday = <a href="#L188" title="loslib.c:188">getfield</a>(L, <span class="Constant">&quot;day&quot;</span>, -<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; ts.tm_mon = <a href="#L188" title="loslib.c:188">getfield</a>(L, <span class="Constant">&quot;month&quot;</span>, -<span class="Constant">1</span>) - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; ts.tm_year = <a href="#L188" title="loslib.c:188">getfield</a>(L, <span class="Constant">&quot;year&quot;</span>, -<span class="Constant">1</span>) - <span class="Constant">1900</span>;<br/></li>
<li>&nbsp; &nbsp; ts.tm_isdst = <a href="#L180" title="loslib.c:180">getboolfield</a>(L, <span class="Constant">&quot;isdst&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; t = mktime(&amp;ts);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">if</span> (t != (<span class="Type">time_t</span>)(<a href="#L47" title="loslib.c:47">l_timet</a>)t)<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.c.html#L212" title="lauxlib.c:212">luaL_error</a>(L, <span class="Constant">&quot;time result <a href="luac.c.html#L44" title="luac.c:44">cannot</a> be represented in this Lua instalation&quot;</span>);<br/></li>
<li>&nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (t == (<span class="Type">time_t</span>)(-<span class="Constant">1</span>))<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L448" title="lapi.c:448">lua_pushnil</a>(L);<br/></li>
<li>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L48" title="loslib.c:48">l_pushtime</a>(L, t);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L299">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_difftime</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">double</span> res = difftime((<a href="#L49" title="loslib.c:49">l_checktime</a>(L, <span class="Constant">1</span>)), (<a href="#L49" title="loslib.c:49">l_checktime</a>(L, <span class="Constant">2</span>)));<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, (<a href="lua.h.html#L87" title="lua.h:87">lua_Number</a>)res);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* }====================================================== */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L308">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_setlocale</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">static</span> <span class="Type">const</span> <span class="Type">int</span> cat[] = {<span class="Constant">LC_ALL</span>, <span class="Constant">LC_COLLATE</span>, <span class="Constant">LC_CTYPE</span>, <span class="Constant">LC_MONETARY</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">LC_NUMERIC</span>, <span class="Constant">LC_TIME</span>};<br/></li>
<li>&nbsp; <span class="Type">static</span> <span class="Type">const</span> <span class="Type">char</span> *<span class="Type">const</span> catnames[] = {<span class="Constant">&quot;all&quot;</span>, <span class="Constant">&quot;collate&quot;</span>, <span class="Constant">&quot;ctype&quot;</span>, <span class="Constant">&quot;monetary&quot;</span>,<br/></li>
<li>&nbsp; &nbsp;&nbsp; <span class="Constant">&quot;numeric&quot;</span>, <span class="Constant">&quot;time&quot;</span>, <span class="Constant">NULL</span>};<br/></li>
<li>&nbsp; <span class="Type">const</span> <span class="Type">char</span> *l = <a href="lauxlib.h.html#L117" title="lauxlib.h:117">luaL_optstring</a>(L, <span class="Constant">1</span>, <span class="Constant">NULL</span>);<br/></li>
<li>&nbsp; <span class="Type">int</span> op = <a href="lauxlib.c.html#L337" title="lauxlib.c:337">luaL_checkoption</a>(L, <span class="Constant">2</span>, <span class="Constant">&quot;all&quot;</span>, catnames);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L484" title="lapi.c:484">lua_pushstring</a>(L, setlocale(cat[op], l));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L320">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">os_exit</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">int</span> status;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lua.h.html#L354" title="lua.h:354">lua_isboolean</a>(L, <span class="Constant">1</span>))<br/></li>
<li>&nbsp; &nbsp; status = (<a href="lapi.c.html#L366" title="lapi.c:366">lua_toboolean</a>(L, <span class="Constant">1</span>) ? <span class="Constant">EXIT_SUCCESS</span> : <span class="Constant">EXIT_FAILURE</span>);<br/></li>
<li>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; status = (<span class="Type">int</span>)<a href="lauxlib.c.html#L424" title="lauxlib.c:424">luaL_optinteger</a>(L, <span class="Constant">1</span>, <span class="Constant">EXIT_SUCCESS</span>);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L366" title="lapi.c:366">lua_toboolean</a>(L, <span class="Constant">2</span>))<br/></li>
<li>&nbsp; &nbsp; <a href="lstate.c.html#L340" title="lstate.c:340">lua_close</a>(L);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (L) exit(status);&nbsp; <span class="Comment">/* 'if' to avoid warnings for unreachable 'return' */<br/></li>
<li></span>&nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L333">&#x200c;</a><span class="Type">static</span> <span class="Type">const</span> <a href="lauxlib.h.html#L23" title="lauxlib.h:23">luaL_Reg</a> <span class="linkable">syslib</span>[] = {<br/></li>
<li>&nbsp; {<span class="Constant">&quot;clock&quot;</span>,&nbsp; &nbsp;&nbsp; <a href="#L154" title="loslib.c:154">os_clock</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;date&quot;</span>,&nbsp; &nbsp; &nbsp; <a href="#L226" title="loslib.c:226">os_date</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;difftime&quot;</span>,&nbsp; <a href="#L299" title="loslib.c:299">os_difftime</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;execute&quot;</span>,&nbsp;&nbsp; <a href="#L112" title="loslib.c:112">os_execute</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;exit&quot;</span>,&nbsp; &nbsp; &nbsp; <a href="#L320" title="loslib.c:320">os_exit</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;getenv&quot;</span>,&nbsp; &nbsp; <a href="#L148" title="loslib.c:148">os_getenv</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;remove&quot;</span>,&nbsp; &nbsp; <a href="#L124" title="loslib.c:124">os_remove</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;rename&quot;</span>,&nbsp; &nbsp; <a href="#L130" title="loslib.c:130">os_rename</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;setlocale&quot;</span>, <a href="#L308" title="loslib.c:308">os_setlocale</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;time&quot;</span>,&nbsp; &nbsp; &nbsp; <a href="#L272" title="loslib.c:272">os_time</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;tmpname&quot;</span>,&nbsp;&nbsp; <a href="#L137" title="loslib.c:137">os_tmpname</a>},<br/></li>
<li>&nbsp; {<span class="Constant">NULL</span>, <span class="Constant">NULL</span>}<br/></li>
<li>};<br/></li>
<li><br/></li>
<li><span class="Comment">/* }====================================================== */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L352">&#x200c;</a><a href="luaconf.h.html#L236" title="luaconf.h:236">LUAMOD_API</a> <span class="Type">int</span> <span class="linkable">luaopen_os</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lauxlib.h.html#L111" title="lauxlib.h:111">luaL_newlib</a>(L, <a href="#L333" title="loslib.c:333">syslib</a>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
</ol></code>
 </body>
</html>
