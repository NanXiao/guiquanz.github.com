<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>lmathlib.c - src</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
  <h3>lmathlib.c - src</h3>
   <a href="../index.html"> Table of Contents </a>
 <h4>Global variables defined</h4>
 <ul>
<li><a href="#L346">mathlib</a></li>
</ul>
 <h4>Functions defined</h4>
 <ul>
<li><a href="#L392">luaopen_math</a></li>
<li><a href="#L39">math_abs</a></li>
<li><a href="#L70">math_acos</a></li>
<li><a href="#L65">math_asin</a></li>
<li><a href="#L75">math_atan</a></li>
<li><a href="#L116">math_ceil</a></li>
<li><a href="#L55">math_cos</a></li>
<li><a href="#L300">math_cosh</a></li>
<li><a href="#L198">math_deg</a></li>
<li><a href="#L193">math_exp</a></li>
<li><a href="#L105">math_floor</a></li>
<li><a href="#L127">math_fmod</a></li>
<li><a href="#L322">math_frexp</a></li>
<li><a href="#L329">math_ldexp</a></li>
<li><a href="#L179">math_log</a></li>
<li><a href="#L336">math_log10</a></li>
<li><a href="#L223">math_max</a></li>
<li><a href="#L209">math_min</a></li>
<li><a href="#L149">math_modf</a></li>
<li><a href="#L315">math_pow</a></li>
<li><a href="#L203">math_rad</a></li>
<li><a href="#L241">math_random</a></li>
<li><a href="#L271">math_randomseed</a></li>
<li><a href="#L50">math_sin</a></li>
<li><a href="#L305">math_sinh</a></li>
<li><a href="#L166">math_sqrt</a></li>
<li><a href="#L60">math_tan</a></li>
<li><a href="#L310">math_tanh</a></li>
<li><a href="#L83">math_toint</a></li>
<li><a href="#L278">math_type</a></li>
<li><a href="#L172">math_ult</a></li>
<li><a href="#L96">pushnumint</a></li>
</ul>
 <h4>Macros defined</h4>
 <ul>
<li><a href="#L8">LUA_LIB</a></li>
<li><a href="#L30">L_RANDMAX</a></li>
<li><a href="#L34">L_RANDMAX</a></li>
<li><a href="#L22">PI</a></li>
<li><a href="#L23">PI</a></li>
<li><a href="#L28">l_rand</a></li>
<li><a href="#L32">l_rand</a></li>
<li><a href="#L29">l_srand</a></li>
<li><a href="#L33">l_srand</a></li>
<li><a href="#L7">lmathlib_c</a></li>
</ul>
 <h4>Source code</h4>

  <code><ol><li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** $Id: lmathlib.c,v 1.114 2014/12/27 20:32:26 roberto Exp $<br/></li>
<li></span><span class="Comment">** Standard mathematical library<br/></li>
<li></span><span class="Comment">** See Copyright Notice in lua.h<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><a id="L7">&#x200c;</a><span class="PreProc">#define <span class="linkable">lmathlib_c</span><br/></li>
<li><a id="L8">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LUA_LIB</span><br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lprefix.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;stdlib.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;math.h&gt;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lua.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lauxlib.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;lualib.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L22">&#x200c;</a><span class="PreProc">#undef <span class="linkable">PI</span><br/></li>
<li><a id="L23">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PI</span>&nbsp; &nbsp; &nbsp; &nbsp; (<a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(</span><span class="Constant">3.141592653589793238462643383279502884</span><span class="PreProc">))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#if !defined(<a href="#L28" title="lmathlib.c:28">l_rand</a>)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* { */<br/></li>
<li></span><span class="PreProc">#if defined(<a href="luaconf.h.html#L62" title="luaconf.h:62">LUA_USE_POSIX</a>)<br/></li>
<li><a id="L28">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_rand</span>()&nbsp; &nbsp; &nbsp; &nbsp; random()<br/></li>
<li><a id="L29">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_srand</span>(x)&nbsp; &nbsp; &nbsp; &nbsp; srandom(x)<br/></li>
<li><a id="L30">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">L_RANDMAX</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">2147483647</span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* (2^31 - 1), following POSIX */<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L32">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_rand</span>()&nbsp; &nbsp; &nbsp; &nbsp; rand()<br/></li>
<li><a id="L33">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">l_srand</span>(x)&nbsp; &nbsp; &nbsp; &nbsp; srand(x)<br/></li>
<li><a id="L34">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">L_RANDMAX</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">RAND_MAX<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#endif</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* } */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L39">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_abs</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L, <span class="Constant">1</span>)) {<br/></li>
<li>&nbsp; &nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> n = <a href="lua.h.html#L340" title="lua.h:340">lua_tointeger</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (n &lt; <span class="Constant">0</span>) n = (<a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a>)(<span class="Constant">0u</span> - n);<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, n);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(fabs)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L50">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_sin</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(sin)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L55">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_cos</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(cos)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L60">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_tan</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(tan)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L65">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_asin</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(asin)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L70">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_acos</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(acos)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L75">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_atan</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> y = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> x = <a href="lauxlib.c.html#L401" title="lauxlib.c:401">luaL_optnumber</a>(L, <span class="Constant">2</span>, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(atan2)(y, x));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L83">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_toint</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">int</span> valid;<br/></li>
<li>&nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> n = <a href="lapi.c.html#L355" title="lapi.c:355">lua_tointegerx</a>(L, <span class="Constant">1</span>, &amp;valid);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (valid)<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, n);<br/></li>
<li>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.c.html#L368" title="lauxlib.c:368">luaL_checkany</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L448" title="lapi.c:448">lua_pushnil</a>(L);&nbsp; <span class="Comment">/* value is not convertible to integer */<br/></li>
<li></span>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L96">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">pushnumint</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L, <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> d) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> n;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="luaconf.h.html#L463" title="luaconf.h:463">lua_numbertointeger</a>(d, &amp;n))&nbsp; <span class="Comment">/* does 'd' fit in an integer? */<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, n);&nbsp; <span class="Comment">/* result is integer */<br/></li>
<li></span>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, d);&nbsp; <span class="Comment">/* result is float */<br/></li>
<li></span>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L105">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_floor</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L, <span class="Constant">1</span>))<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L171" title="lapi.c:171">lua_settop</a>(L, <span class="Constant">1</span>);&nbsp; <span class="Comment">/* integer is its own floor */<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> d = <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(floor)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>));<br/></li>
<li>&nbsp; &nbsp; <a href="#L96" title="lmathlib.c:96">pushnumint</a>(L, d);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L116">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_ceil</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L, <span class="Constant">1</span>))<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L171" title="lapi.c:171">lua_settop</a>(L, <span class="Constant">1</span>);&nbsp; <span class="Comment">/* integer is its own ceil */<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> d = <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(ceil)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>));<br/></li>
<li>&nbsp; &nbsp; <a href="#L96" title="lmathlib.c:96">pushnumint</a>(L, d);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L127">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_fmod</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L, <span class="Constant">1</span>) &amp;&amp; <a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L, <span class="Constant">2</span>)) {<br/></li>
<li>&nbsp; &nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> d = <a href="lua.h.html#L340" title="lua.h:340">lua_tointeger</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> ((<a href="lua.h.html#L94" title="lua.h:94">lua_Unsigned</a>)d + <span class="Constant">1u</span> &lt;= <span class="Constant">1u</span>) {&nbsp; <span class="Comment">/* special cases: -1 or 0 */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="lauxlib.h.html#L114" title="lauxlib.h:114">luaL_argcheck</a>(L, d != <span class="Constant">0</span>, <span class="Constant">2</span>, <span class="Constant">&quot;zero&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, <span class="Constant">0</span>);&nbsp; <span class="Comment">/* avoid overflow with 0x80000... / -1 */<br/></li>
<li></span>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, <a href="lua.h.html#L340" title="lua.h:340">lua_tointeger</a>(L, <span class="Constant">1</span>) % d);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(fmod)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">2</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** <a href="llex.c.html#L31" title="llex.c:31">next</a> function does not use 'modf', avoiding problems with 'double*'<br/></li>
<li></span><span class="Comment">** (which is not compatible with 'float*') when <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> is not<br/></li>
<li></span><span class="Comment">** 'double'.<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L149">&#x200c;</a></span><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_modf</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L ,<span class="Constant">1</span>)) {<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L171" title="lapi.c:171">lua_settop</a>(L, <span class="Constant">1</span>);&nbsp; <span class="Comment">/* number is its own integer part */<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <span class="Constant">0</span>);&nbsp; <span class="Comment">/* no fractional part */<br/></li>
<li></span>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> n = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* integer part (rounds toward zero) */<br/></li>
<li></span>&nbsp; &nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> ip = (n &lt; <span class="Constant">0</span>) ? <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(ceil)(n) : <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(floor)(n);<br/></li>
<li>&nbsp; &nbsp; <a href="#L96" title="lmathlib.c:96">pushnumint</a>(L, ip);<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* fractional part (test needed for inf/-inf) */<br/></li>
<li></span>&nbsp; &nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, (n == ip) ? <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(<span class="Constant">0.0</span>) : (n - ip));<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">2</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L166">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_sqrt</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(sqrt)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L172">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_ult</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> a = <a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> b = <a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L550" title="lapi.c:550">lua_pushboolean</a>(L, (<a href="lua.h.html#L94" title="lua.h:94">lua_Unsigned</a>)a &lt; (<a href="lua.h.html#L94" title="lua.h:94">lua_Unsigned</a>)b);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L179">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_log</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> x = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> res;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lua.h.html#L357" title="lua.h:357">lua_isnoneornil</a>(L, <span class="Constant">2</span>))<br/></li>
<li>&nbsp; &nbsp; res = <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(log)(x);<br/></li>
<li>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> base = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (base == <span class="Constant">10.0</span>) res = <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(log10)(x);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> res = <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(log)(x)/<a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(log)(base);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, res);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L193">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_exp</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(exp)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L198">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_deg</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>) * (<a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(<span class="Constant">180.0</span>) / <a href="#L22" title="lmathlib.c:22">PI</a>));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L203">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_rad</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>) * (<a href="#L22" title="lmathlib.c:22">PI</a> / <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(<span class="Constant">180.0</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L209">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_min</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">int</span> n = <a href="lapi.c.html#L166" title="lapi.c:166">lua_gettop</a>(L);&nbsp; <span class="Comment">/* number of arguments */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> imin = <span class="Constant">1</span>;&nbsp; <span class="Comment">/* index of current minimum value */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; <a href="lauxlib.h.html#L114" title="lauxlib.h:114">luaL_argcheck</a>(L, n &gt;= <span class="Constant">1</span>, <span class="Constant">1</span>, <span class="Constant">&quot;value expected&quot;</span>);<br/></li>
<li>&nbsp; <span class="Statement">for</span> (i = <span class="Constant">2</span>; i &lt;= n; i++) {<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L317" title="lapi.c:317">lua_compare</a>(L, i, imin, <a href="lua.h.html#L212" title="lua.h:212">LUA_OPLT</a>))<br/></li>
<li>&nbsp; &nbsp; &nbsp; imin = i;<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <a href="lapi.c.html#L236" title="lapi.c:236">lua_pushvalue</a>(L, imin);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L223">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_max</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">int</span> n = <a href="lapi.c.html#L166" title="lapi.c:166">lua_gettop</a>(L);&nbsp; <span class="Comment">/* number of arguments */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> imax = <span class="Constant">1</span>;&nbsp; <span class="Comment">/* index of current maximum value */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; <a href="lauxlib.h.html#L114" title="lauxlib.h:114">luaL_argcheck</a>(L, n &gt;= <span class="Constant">1</span>, <span class="Constant">1</span>, <span class="Constant">&quot;value expected&quot;</span>);<br/></li>
<li>&nbsp; <span class="Statement">for</span> (i = <span class="Constant">2</span>; i &lt;= n; i++) {<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L317" title="lapi.c:317">lua_compare</a>(L, imax, i, <a href="lua.h.html#L212" title="lua.h:212">LUA_OPLT</a>))<br/></li>
<li>&nbsp; &nbsp; &nbsp; imax = i;<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <a href="lapi.c.html#L236" title="lapi.c:236">lua_pushvalue</a>(L, imax);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** This function uses 'double' (instead of '<a href="lua.h.html#L87" title="lua.h:87">lua_Number</a>') to ensure that<br/></li>
<li></span><span class="Comment">** all bits from '<a href="#L28" title="lmathlib.c:28">l_rand</a>' can be represented, and that 'RANDMAX + 1.0'<br/></li>
<li></span><span class="Comment">** will keep full precision (ensuring that 'r' is always less than 1.0.)<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L241">&#x200c;</a></span><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_random</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a> low, up;<br/></li>
<li>&nbsp; <span class="Type">double</span> r = (<span class="Type">double</span>)<a href="#L28" title="lmathlib.c:28">l_rand</a>() * (<span class="Constant">1.0</span> / ((<span class="Type">double</span>)<a href="#L30" title="lmathlib.c:30">L_RANDMAX</a> + <span class="Constant">1.0</span>));<br/></li>
<li>&nbsp; <span class="Statement">switch</span> (<a href="lapi.c.html#L166" title="lapi.c:166">lua_gettop</a>(L)) {&nbsp; <span class="Comment">/* <a href="lparser.c.html#L106" title="lparser.c:106">check</a> number of arguments */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">0</span>: {&nbsp; <span class="Comment">/* no arguments */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, (<a href="lua.h.html#L87" title="lua.h:87">lua_Number</a>)r);&nbsp; <span class="Comment">/* Number between 0 and 1 */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">1</span>: {&nbsp; <span class="Comment">/* only upper limit */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; low = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; up = <a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">2</span>: {&nbsp; <span class="Comment">/* lower and upper limits */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; low = <a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; up = <a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><span class="cUserCont">&nbsp; &nbsp; </span><span class="Statement">default</span><span class="cUserCont">:</span> <span class="Statement">return</span> <a href="lauxlib.c.html#L212" title="lauxlib.c:212">luaL_error</a>(L, <span class="Constant">&quot;wrong number of arguments&quot;</span>);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Comment">/* random integer in the interval [low, up] */<br/></li>
<li></span>&nbsp; <a href="lauxlib.h.html#L114" title="lauxlib.h:114">luaL_argcheck</a>(L, low &lt;= up, <span class="Constant">1</span>, <span class="Constant">&quot;interval is empty&quot;</span>);<br/></li>
<li>&nbsp; <a href="lauxlib.h.html#L114" title="lauxlib.h:114">luaL_argcheck</a>(L, low &gt;= <span class="Constant">0</span> || up &lt;= <a href="luaconf.h.html#L546" title="luaconf.h:546">LUA_MAXINTEGER</a> + low, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;interval too large&quot;</span>);<br/></li>
<li>&nbsp; r *= (<span class="Type">double</span>)(up - low) + <span class="Constant">1.0</span>;<br/></li>
<li>&nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, (<a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a>)r + low);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L271">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_randomseed</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="#L29" title="lmathlib.c:29">l_srand</a>((<span class="Type">unsigned</span> <span class="Type">int</span>)(<a href="lua.h.html#L91" title="lua.h:91">lua_Integer</a>)<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>));<br/></li>
<li>&nbsp; (<span class="Type">void</span>)rand(); <span class="Comment">/* discard first value to avoid undesirable correlations */<br/></li>
<li></span>&nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L278">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_type</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L250" title="lapi.c:250">lua_type</a>(L, <span class="Constant">1</span>) == <a href="lua.h.html#L65" title="lua.h:65">LUA_TNUMBER</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="lapi.c.html#L269" title="lapi.c:269">lua_isinteger</a>(L, <span class="Constant">1</span>))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="lua.h.html#L359" title="lua.h:359">lua_pushliteral</a>(L, <span class="Constant">&quot;integer&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="lua.h.html#L359" title="lua.h:359">lua_pushliteral</a>(L, <span class="Constant">&quot;float&quot;</span>);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; <a href="lauxlib.c.html#L368" title="lauxlib.c:368">luaL_checkany</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="lapi.c.html#L448" title="lapi.c:448">lua_pushnil</a>(L);<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** {==================================================================<br/></li>
<li></span><span class="Comment">** Deprecated functions (for compatibility only)<br/></li>
<li></span><span class="Comment">** ===================================================================<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><span class="PreProc">#if defined(<a href="luaconf.h.html#L284" title="luaconf.h:284">LUA_COMPAT_MATHLIB</a>)<br/></li>
<li></span><br/></li>
<li><a id="L300">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_cosh</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(cosh)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L305">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_sinh</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(sinh)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L310">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_tanh</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(tanh)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L315">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_pow</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> x = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> y = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(pow)(x, y));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L322">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_frexp</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <span class="Type">int</span> e;<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(frexp)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>), &amp;e));<br/></li>
<li>&nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, e);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">2</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L329">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_ldexp</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> x = <a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; <span class="Type">int</span> ep = (<span class="Type">int</span>)<a href="lauxlib.c.html#L414" title="lauxlib.c:414">luaL_checkinteger</a>(L, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(ldexp)(x, ep));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L336">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">math_log10</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="luaconf.h.html#L412" title="luaconf.h:412">l_mathop</a>(log10)(<a href="lauxlib.c.html#L392" title="lauxlib.c:392">luaL_checknumber</a>(L, <span class="Constant">1</span>)));<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><span class="Comment">/* }================================================================== */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L346">&#x200c;</a><span class="Type">static</span> <span class="Type">const</span> <a href="lauxlib.h.html#L23" title="lauxlib.h:23">luaL_Reg</a> <span class="linkable">mathlib</span>[] = {<br/></li>
<li>&nbsp; {<span class="Constant">&quot;abs&quot;</span>,&nbsp;&nbsp; <a href="#L39" title="lmathlib.c:39">math_abs</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;acos&quot;</span>,&nbsp; <a href="#L70" title="lmathlib.c:70">math_acos</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;asin&quot;</span>,&nbsp; <a href="#L65" title="lmathlib.c:65">math_asin</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;atan&quot;</span>,&nbsp; <a href="#L75" title="lmathlib.c:75">math_atan</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;ceil&quot;</span>,&nbsp; <a href="#L116" title="lmathlib.c:116">math_ceil</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;cos&quot;</span>,&nbsp;&nbsp; <a href="#L55" title="lmathlib.c:55">math_cos</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;deg&quot;</span>,&nbsp;&nbsp; <a href="#L198" title="lmathlib.c:198">math_deg</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;exp&quot;</span>,&nbsp;&nbsp; <a href="#L193" title="lmathlib.c:193">math_exp</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;<a href="lvm.h.html#L33" title="lvm.h:33">tointeger</a>&quot;</span>, <a href="#L83" title="lmathlib.c:83">math_toint</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;floor&quot;</span>, <a href="#L105" title="lmathlib.c:105">math_floor</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;fmod&quot;</span>,&nbsp;&nbsp; <a href="#L127" title="lmathlib.c:127">math_fmod</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;ult&quot;</span>,&nbsp;&nbsp; <a href="#L172" title="lmathlib.c:172">math_ult</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;log&quot;</span>,&nbsp;&nbsp; <a href="#L179" title="lmathlib.c:179">math_log</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;max&quot;</span>,&nbsp;&nbsp; <a href="#L223" title="lmathlib.c:223">math_max</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;min&quot;</span>,&nbsp;&nbsp; <a href="#L209" title="lmathlib.c:209">math_min</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;modf&quot;</span>,&nbsp;&nbsp; <a href="#L149" title="lmathlib.c:149">math_modf</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;rad&quot;</span>,&nbsp;&nbsp; <a href="#L203" title="lmathlib.c:203">math_rad</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;random&quot;</span>,&nbsp; &nbsp;&nbsp; <a href="#L241" title="lmathlib.c:241">math_random</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;randomseed&quot;</span>, <a href="#L271" title="lmathlib.c:271">math_randomseed</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;sin&quot;</span>,&nbsp;&nbsp; <a href="#L50" title="lmathlib.c:50">math_sin</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;sqrt&quot;</span>,&nbsp; <a href="#L166" title="lmathlib.c:166">math_sqrt</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;tan&quot;</span>,&nbsp;&nbsp; <a href="#L60" title="lmathlib.c:60">math_tan</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;type&quot;</span>, <a href="#L278" title="lmathlib.c:278">math_type</a>},<br/></li>
<li><span class="PreProc">#if defined(<a href="luaconf.h.html#L284" title="luaconf.h:284">LUA_COMPAT_MATHLIB</a>)<br/></li>
<li></span>&nbsp; {<span class="Constant">&quot;atan2&quot;</span>, <a href="#L75" title="lmathlib.c:75">math_atan</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;cosh&quot;</span>,&nbsp;&nbsp; <a href="#L300" title="lmathlib.c:300">math_cosh</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;sinh&quot;</span>,&nbsp;&nbsp; <a href="#L305" title="lmathlib.c:305">math_sinh</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;tanh&quot;</span>,&nbsp;&nbsp; <a href="#L310" title="lmathlib.c:310">math_tanh</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;pow&quot;</span>,&nbsp;&nbsp; <a href="#L315" title="lmathlib.c:315">math_pow</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;frexp&quot;</span>, <a href="#L322" title="lmathlib.c:322">math_frexp</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;ldexp&quot;</span>, <a href="#L329" title="lmathlib.c:329">math_ldexp</a>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;log10&quot;</span>, <a href="#L336" title="lmathlib.c:336">math_log10</a>},<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; <span class="Comment">/* placeholders */<br/></li>
<li></span>&nbsp; {<span class="Constant">&quot;pi&quot;</span>, <span class="Constant">NULL</span>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;huge&quot;</span>, <span class="Constant">NULL</span>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;maxinteger&quot;</span>, <span class="Constant">NULL</span>},<br/></li>
<li>&nbsp; {<span class="Constant">&quot;mininteger&quot;</span>, <span class="Constant">NULL</span>},<br/></li>
<li>&nbsp; {<span class="Constant">NULL</span>, <span class="Constant">NULL</span>}<br/></li>
<li>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** Open math library<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L392">&#x200c;</a></span><a href="luaconf.h.html#L236" title="luaconf.h:236">LUAMOD_API</a> <span class="Type">int</span> <span class="linkable">luaopen_math</span> (<a href="lstate.h.html#L149" title="lstate.h:149">lua_State</a> *L) {<br/></li>
<li>&nbsp; <a href="lauxlib.h.html#L111" title="lauxlib.h:111">luaL_newlib</a>(L, <a href="#L346" title="lmathlib.c:346">mathlib</a>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, <a href="#L22" title="lmathlib.c:22">PI</a>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L745" title="lapi.c:745">lua_setfield</a>(L, -<span class="Constant">2</span>, <span class="Constant">&quot;pi&quot;</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L456" title="lapi.c:456">lua_pushnumber</a>(L, (<a href="lua.h.html#L87" title="lua.h:87">lua_Number</a>)<span class="Constant">HUGE_VAL</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L745" title="lapi.c:745">lua_setfield</a>(L, -<span class="Constant">2</span>, <span class="Constant">&quot;huge&quot;</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, <a href="luaconf.h.html#L546" title="luaconf.h:546">LUA_MAXINTEGER</a>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L745" title="lapi.c:745">lua_setfield</a>(L, -<span class="Constant">2</span>, <span class="Constant">&quot;maxinteger&quot;</span>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L464" title="lapi.c:464">lua_pushinteger</a>(L, <a href="luaconf.h.html#L547" title="luaconf.h:547">LUA_MININTEGER</a>);<br/></li>
<li>&nbsp; <a href="lapi.c.html#L745" title="lapi.c:745">lua_setfield</a>(L, -<span class="Constant">2</span>, <span class="Constant">&quot;mininteger&quot;</span>);<br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
</ol></code>
 </body>
</html>
