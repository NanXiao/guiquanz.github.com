<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>lopcodes.h - src</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
  <h3>lopcodes.h - src</h3>
   <a href="../index.html"> Table of Contents </a>
 <h4>Global variables defined</h4>
 <ul>
<li><a href="#L279">luaP_opmodes</a></li>
<li><a href="#L288">luaP_opnames</a></li>
</ul>
 <h4>Data types defined</h4>
 <ul>
<li><a href="#L272">OpArgMask</a></li>
<li><a href="#L232">OpCode</a></li>
<li><a href="#L32">OpMode</a></li>
</ul>
 <h4>Macros defined</h4>
 <ul>
<li><a href="#L134">BITRK</a></li>
<li><a href="#L116">CREATE_ABC</a></li>
<li><a href="#L121">CREATE_ABx</a></li>
<li><a href="#L125">CREATE_Ax</a></li>
<li><a href="#L97">GETARG_A</a></li>
<li><a href="#L109">GETARG_Ax</a></li>
<li><a href="#L100">GETARG_B</a></li>
<li><a href="#L106">GETARG_Bx</a></li>
<li><a href="#L103">GETARG_C</a></li>
<li><a href="#L112">GETARG_sBx</a></li>
<li><a href="#L89">GET_OPCODE</a></li>
<li><a href="#L140">INDEXK</a></li>
<li><a href="#L137">ISK</a></li>
<li><a href="#L292">LFIELDS_PER_FLUSH</a></li>
<li><a href="#L83">MASK0</a></li>
<li><a href="#L80">MASK1</a></li>
<li><a href="#L74">MAXARG_A</a></li>
<li><a href="#L68">MAXARG_Ax</a></li>
<li><a href="#L70">MAXARG_Ax</a></li>
<li><a href="#L75">MAXARG_B</a></li>
<li><a href="#L60">MAXARG_Bx</a></li>
<li><a href="#L63">MAXARG_Bx</a></li>
<li><a href="#L76">MAXARG_C</a></li>
<li><a href="#L61">MAXARG_sBx</a></li>
<li><a href="#L64">MAXARG_sBx</a></li>
<li><a href="#L142">MAXINDEXRK</a></li>
<li><a href="#L151">NO_REG</a></li>
<li><a href="#L235">NUM_OPCODES</a></li>
<li><a href="#L47">POS_A</a></li>
<li><a href="#L51">POS_Ax</a></li>
<li><a href="#L49">POS_B</a></li>
<li><a href="#L50">POS_Bx</a></li>
<li><a href="#L48">POS_C</a></li>
<li><a href="#L46">POS_OP</a></li>
<li><a href="#L145">RKASK</a></li>
<li><a href="#L98">SETARG_A</a></li>
<li><a href="#L110">SETARG_Ax</a></li>
<li><a href="#L101">SETARG_B</a></li>
<li><a href="#L107">SETARG_Bx</a></li>
<li><a href="#L104">SETARG_C</a></li>
<li><a href="#L113">SETARG_sBx</a></li>
<li><a href="#L90">SET_OPCODE</a></li>
<li><a href="#L41">SIZE_A</a></li>
<li><a href="#L42">SIZE_Ax</a></li>
<li><a href="#L39">SIZE_B</a></li>
<li><a href="#L40">SIZE_Bx</a></li>
<li><a href="#L38">SIZE_C</a></li>
<li><a href="#L44">SIZE_OP</a></li>
<li><a href="#L282">getBMode</a></li>
<li><a href="#L283">getCMode</a></li>
<li><a href="#L281">getOpMode</a></li>
<li><a href="#L93">getarg</a></li>
<li><a href="#L8">lopcodes_h</a></li>
<li><a href="#L94">setarg</a></li>
<li><a href="#L284">testAMode</a></li>
<li><a href="#L285">testTMode</a></li>
</ul>
 <h4>Source code</h4>

  <code><ol><li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** $Id: lopcodes.h,v 1.148 2014/10/25 11:50:46 roberto Exp $<br/></li>
<li></span><span class="Comment">** Opcodes for Lua virtual machine<br/></li>
<li></span><span class="Comment">** See Copyright Notice in lua.h<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifndef <a href="#L8" title="lopcodes.h:8">lopcodes_h</a><br/></li>
<li><a id="L8">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">lopcodes_h</span><br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;llimits.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*===========================================================================<br/></li>
<li></span><span class="Comment">&nbsp; We assume that instructions are unsigned numbers.<br/></li>
<li></span><span class="Comment">&nbsp; All instructions have an opcode in the first 6 bits.<br/></li>
<li></span><span class="Comment">&nbsp; Instructions can have the following fields:<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; 'A' : 8 bits<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; 'B' : 9 bits<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; 'C' : 9 bits<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; 'Ax' : 26 bits ('A', 'B', and 'C' together)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; 'Bx' : 18 bits ('B' and 'C' together)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; 'sBx' : signed Bx<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; A signed argument is represented in excess K; that is, the number<br/></li>
<li></span><span class="Comment">&nbsp; value is the unsigned value minus K. K is exactly the maximum value<br/></li>
<li></span><span class="Comment">&nbsp; for that argument (so that -max is represented by 0, and +max is<br/></li>
<li></span><span class="Comment">&nbsp; represented by 2*max), which is half the maximum for the corresponding<br/></li>
<li></span><span class="Comment">&nbsp; unsigned argument.<br/></li>
<li></span><span class="Comment">===========================================================================*/<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L32">&#x200c;</a><span class="Type">enum</span> <span class="linkable">OpMode</span> {iABC, iABx, iAsBx, iAx};&nbsp; <span class="Comment">/* basic instruction format */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** size and position of opcode arguments.<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L38">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SIZE_C</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">9<br/></li>
<li><a id="L39">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SIZE_B</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">9<br/></li>
<li><a id="L40">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SIZE_Bx</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L38" title="lopcodes.h:38">SIZE_C</a> + <a href="#L39" title="lopcodes.h:39">SIZE_B</a>)<br/></li>
<li><a id="L41">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SIZE_A</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">8<br/></li>
<li><a id="L42">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SIZE_Ax</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L38" title="lopcodes.h:38">SIZE_C</a> + <a href="#L39" title="lopcodes.h:39">SIZE_B</a> + <a href="#L41" title="lopcodes.h:41">SIZE_A</a>)<br/></li>
<li></span><br/></li>
<li><a id="L44">&#x200c;</a><span class="PreProc">#define <span class="linkable">SIZE_OP</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">6<br/></li>
<li></span><br/></li>
<li><a id="L46">&#x200c;</a><span class="PreProc">#define <span class="linkable">POS_OP</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">0<br/></li>
<li><a id="L47">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">POS_A</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L46" title="lopcodes.h:46">POS_OP</a> + <a href="#L44" title="lopcodes.h:44">SIZE_OP</a>)<br/></li>
<li><a id="L48">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">POS_C</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L47" title="lopcodes.h:47">POS_A</a> + <a href="#L41" title="lopcodes.h:41">SIZE_A</a>)<br/></li>
<li><a id="L49">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">POS_B</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L48" title="lopcodes.h:48">POS_C</a> + <a href="#L38" title="lopcodes.h:38">SIZE_C</a>)<br/></li>
<li><a id="L50">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">POS_Bx</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L48" title="lopcodes.h:48">POS_C</a><br/></li>
<li><a id="L51">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">POS_Ax</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L47" title="lopcodes.h:47">POS_A</a><br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** limits for opcode arguments.<br/></li>
<li></span><span class="Comment">** we use (signed) int to manipulate most arguments,<br/></li>
<li></span><span class="Comment">** so they must fit in <a href="luaconf.h.html#L91" title="luaconf.h:91">LUAI_BITSINT</a>-1 bits (-1 for sign)<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><span class="PreProc">#if <a href="#L40" title="lopcodes.h:40">SIZE_Bx</a> &lt; <a href="luaconf.h.html#L91" title="luaconf.h:91">LUAI_BITSINT</a>-</span><span class="Constant">1<br/></li>
<li><a id="L60">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_Bx</span>&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;<a href="#L40" title="lopcodes.h:40">SIZE_Bx</a>)-</span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li><a id="L61">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_sBx</span>&nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L60" title="lopcodes.h:60">MAXARG_Bx</a>&gt;&gt;</span><span class="Constant">1</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Comment">/* 'sBx' is signed */<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L63">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_Bx</span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L51" title="llimits.h:51">MAX_INT</a><br/></li>
<li><a id="L64">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_sBx</span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L51" title="llimits.h:51">MAX_INT</a><br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if <a href="#L42" title="lopcodes.h:42">SIZE_Ax</a> &lt; <a href="luaconf.h.html#L91" title="luaconf.h:91">LUAI_BITSINT</a>-</span><span class="Constant">1<br/></li>
<li><a id="L68">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_Ax</span>&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;<a href="#L42" title="lopcodes.h:42">SIZE_Ax</a>)-</span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L70">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_Ax</span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L51" title="llimits.h:51">MAX_INT</a><br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L74">&#x200c;</a><span class="PreProc">#define <span class="linkable">MAXARG_A</span>&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;<a href="#L41" title="lopcodes.h:41">SIZE_A</a>)-</span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li><a id="L75">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_B</span>&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;<a href="#L39" title="lopcodes.h:39">SIZE_B</a>)-</span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li><a id="L76">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MAXARG_C</span>&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;<a href="#L38" title="lopcodes.h:38">SIZE_C</a>)-</span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* creates a <a href="lbitlib.c.html#L41" title="lbitlib.c:41">mask</a> with 'n' 1 bits at position 'p' */<br/></li>
<li><a id="L80">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MASK1</span>(n,p)&nbsp; &nbsp; &nbsp; &nbsp; ((~((~(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>)</span><span class="Constant">0</span><span class="PreProc">)&lt;&lt;(n)))&lt;&lt;(p))<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* creates a <a href="lbitlib.c.html#L41" title="lbitlib.c:41">mask</a> with 'n' 0 bits at position 'p' */<br/></li>
<li><a id="L83">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MASK0</span>(n,p)&nbsp; &nbsp; &nbsp; &nbsp; (~<a href="#L80" title="lopcodes.h:80">MASK1</a>(n,p))<br/></li>
<li></span><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** the following macros help to manipulate instructions<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><a id="L89">&#x200c;</a><span class="PreProc">#define <span class="linkable">GET_OPCODE</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="#L232" title="lopcodes.h:232">OpCode</a>, ((i)&gt;&gt;<a href="#L46" title="lopcodes.h:46">POS_OP</a>) &amp; <a href="#L80" title="lopcodes.h:80">MASK1</a>(<a href="#L44" title="lopcodes.h:44">SIZE_OP</a>,</span><span class="Constant">0</span><span class="PreProc">)))<br/></li>
<li><a id="L90">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SET_OPCODE</span>(i,o)&nbsp; &nbsp; &nbsp; &nbsp; ((i) = (((i)&amp;<a href="#L83" title="lopcodes.h:83">MASK0</a>(<a href="#L44" title="lopcodes.h:44">SIZE_OP</a>,<a href="#L46" title="lopcodes.h:46">POS_OP</a>)) | \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, o)&lt;&lt;<a href="#L46" title="lopcodes.h:46">POS_OP</a>)&amp;<a href="#L80" title="lopcodes.h:80">MASK1</a>(<a href="#L44" title="lopcodes.h:44">SIZE_OP</a>,<a href="#L46" title="lopcodes.h:46">POS_OP</a>))))<br/></li>
<li></span><br/></li>
<li><a id="L93">&#x200c;</a><span class="PreProc">#define <span class="linkable">getarg</span>(i,pos,size)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">int</span><span class="PreProc">, ((i)&gt;&gt;pos) &amp; <a href="#L80" title="lopcodes.h:80">MASK1</a>(size,</span><span class="Constant">0</span><span class="PreProc">)))<br/></li>
<li><a id="L94">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">setarg</span>(i,v,pos,size)&nbsp; &nbsp; &nbsp; &nbsp; ((i) = (((i)&amp;<a href="#L83" title="lopcodes.h:83">MASK0</a>(size,pos)) | \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, v)&lt;&lt;pos)&amp;<a href="#L80" title="lopcodes.h:80">MASK1</a>(size,pos))))<br/></li>
<li></span><br/></li>
<li><a id="L97">&#x200c;</a><span class="PreProc">#define <span class="linkable">GETARG_A</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="lopcodes.h:93">getarg</a>(i, <a href="#L47" title="lopcodes.h:47">POS_A</a>, <a href="#L41" title="lopcodes.h:41">SIZE_A</a>)<br/></li>
<li><a id="L98">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SETARG_A</span>(i,v)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L94" title="lopcodes.h:94">setarg</a>(i, v, <a href="#L47" title="lopcodes.h:47">POS_A</a>, <a href="#L41" title="lopcodes.h:41">SIZE_A</a>)<br/></li>
<li></span><br/></li>
<li><a id="L100">&#x200c;</a><span class="PreProc">#define <span class="linkable">GETARG_B</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="lopcodes.h:93">getarg</a>(i, <a href="#L49" title="lopcodes.h:49">POS_B</a>, <a href="#L39" title="lopcodes.h:39">SIZE_B</a>)<br/></li>
<li><a id="L101">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SETARG_B</span>(i,v)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L94" title="lopcodes.h:94">setarg</a>(i, v, <a href="#L49" title="lopcodes.h:49">POS_B</a>, <a href="#L39" title="lopcodes.h:39">SIZE_B</a>)<br/></li>
<li></span><br/></li>
<li><a id="L103">&#x200c;</a><span class="PreProc">#define <span class="linkable">GETARG_C</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="lopcodes.h:93">getarg</a>(i, <a href="#L48" title="lopcodes.h:48">POS_C</a>, <a href="#L38" title="lopcodes.h:38">SIZE_C</a>)<br/></li>
<li><a id="L104">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SETARG_C</span>(i,v)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L94" title="lopcodes.h:94">setarg</a>(i, v, <a href="#L48" title="lopcodes.h:48">POS_C</a>, <a href="#L38" title="lopcodes.h:38">SIZE_C</a>)<br/></li>
<li></span><br/></li>
<li><a id="L106">&#x200c;</a><span class="PreProc">#define <span class="linkable">GETARG_Bx</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="lopcodes.h:93">getarg</a>(i, <a href="#L50" title="lopcodes.h:50">POS_Bx</a>, <a href="#L40" title="lopcodes.h:40">SIZE_Bx</a>)<br/></li>
<li><a id="L107">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SETARG_Bx</span>(i,v)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L94" title="lopcodes.h:94">setarg</a>(i, v, <a href="#L50" title="lopcodes.h:50">POS_Bx</a>, <a href="#L40" title="lopcodes.h:40">SIZE_Bx</a>)<br/></li>
<li></span><br/></li>
<li><a id="L109">&#x200c;</a><span class="PreProc">#define <span class="linkable">GETARG_Ax</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="lopcodes.h:93">getarg</a>(i, <a href="#L51" title="lopcodes.h:51">POS_Ax</a>, <a href="#L42" title="lopcodes.h:42">SIZE_Ax</a>)<br/></li>
<li><a id="L110">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SETARG_Ax</span>(i,v)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L94" title="lopcodes.h:94">setarg</a>(i, v, <a href="#L51" title="lopcodes.h:51">POS_Ax</a>, <a href="#L42" title="lopcodes.h:42">SIZE_Ax</a>)<br/></li>
<li></span><br/></li>
<li><a id="L112">&#x200c;</a><span class="PreProc">#define <span class="linkable">GETARG_sBx</span>(i)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L106" title="lopcodes.h:106">GETARG_Bx</a>(i)-<a href="#L61" title="lopcodes.h:61">MAXARG_sBx</a>)<br/></li>
<li><a id="L113">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SETARG_sBx</span>(i,b)&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L107" title="lopcodes.h:107">SETARG_Bx</a>((i),<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">unsigned</span><span class="PreProc"> </span><span class="Type">int</span><span class="PreProc">, (b)+<a href="#L61" title="lopcodes.h:61">MAXARG_sBx</a>))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L116">&#x200c;</a><span class="PreProc">#define <span class="linkable">CREATE_ABC</span>(o,a,b,c)&nbsp; &nbsp; &nbsp; &nbsp; ((<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, o)&lt;&lt;<a href="#L46" title="lopcodes.h:46">POS_OP</a>) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, a)&lt;&lt;<a href="#L47" title="lopcodes.h:47">POS_A</a>) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, b)&lt;&lt;<a href="#L49" title="lopcodes.h:49">POS_B</a>) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, c)&lt;&lt;<a href="#L48" title="lopcodes.h:48">POS_C</a>))<br/></li>
<li></span><br/></li>
<li><a id="L121">&#x200c;</a><span class="PreProc">#define <span class="linkable">CREATE_ABx</span>(o,a,bc)&nbsp; &nbsp; &nbsp; &nbsp; ((<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, o)&lt;&lt;<a href="#L46" title="lopcodes.h:46">POS_OP</a>) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, a)&lt;&lt;<a href="#L47" title="lopcodes.h:47">POS_A</a>) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, bc)&lt;&lt;<a href="#L50" title="lopcodes.h:50">POS_Bx</a>))<br/></li>
<li></span><br/></li>
<li><a id="L125">&#x200c;</a><span class="PreProc">#define <span class="linkable">CREATE_Ax</span>(o,a)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, o)&lt;&lt;<a href="#L46" title="lopcodes.h:46">POS_OP</a>) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(<a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a>, a)&lt;&lt;<a href="#L51" title="lopcodes.h:51">POS_Ax</a>))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** Macros to operate RK indices<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* this bit 1 means constant (0 means register) */<br/></li>
<li><a id="L134">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">BITRK</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc"> &lt;&lt; (<a href="#L39" title="lopcodes.h:39">SIZE_B</a> - </span><span class="Constant">1</span><span class="PreProc">))<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* test whether value is a constant */<br/></li>
<li><a id="L137">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ISK</span>(x)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((x) &amp; <a href="#L134" title="lopcodes.h:134">BITRK</a>)<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* gets the index of the constant */<br/></li>
<li><a id="L140">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">INDEXK</span>(r)&nbsp; &nbsp; &nbsp; &nbsp; ((</span><span class="Type">int</span><span class="PreProc">)(r) &amp; ~<a href="#L134" title="lopcodes.h:134">BITRK</a>)<br/></li>
<li></span><br/></li>
<li><a id="L142">&#x200c;</a><span class="PreProc">#define <span class="linkable">MAXINDEXRK</span>&nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L134" title="lopcodes.h:134">BITRK</a> - </span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* code a constant index as a RK value */<br/></li>
<li><a id="L145">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">RKASK</span>(x)&nbsp; &nbsp; &nbsp; &nbsp; ((x) | <a href="#L134" title="lopcodes.h:134">BITRK</a>)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** invalid register that fits in 8 bits<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L151">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">NO_REG</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L74" title="lopcodes.h:74">MAXARG_A</a><br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** R(x) - register<br/></li>
<li></span><span class="Comment">** Kst(x) - constant (in constant table)<br/></li>
<li></span><span class="Comment">** RK(x) == if <a href="#L137" title="lopcodes.h:137">ISK</a>(x) then Kst(<a href="#L140" title="lopcodes.h:140">INDEXK</a>(x)) else R(x)<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** grep &quot;ORDER OP&quot; if you change these enums<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="Type">typedef</span> <span class="Type">enum</span> {<br/></li>
<li><span class="Comment">/*----------------------------------------------------------------------<br/></li>
<li></span><span class="Comment">name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; args&nbsp; &nbsp; &nbsp; &nbsp; description<br/></li>
<li></span><span class="Comment">------------------------------------------------------------------------*/<br/></li>
<li></span>OP_MOVE,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A) := R(B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LOADK,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A Bx&nbsp; &nbsp; &nbsp; &nbsp; R(A) := Kst(Bx)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LOADKX,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; R(A) := Kst(extra arg)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LOADBOOL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := (Bool)B; if (C) pc++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LOADNIL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A), R(A+1), ..., R(A+B) := nil&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_GETUPVAL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A) := UpValue[B]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_GETTABUP,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := UpValue[B][RK(C)]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_GETTABLE,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := R(B)[RK(C)]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_SETTABUP,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; UpValue[A][RK(B)] := RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_SETUPVAL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; UpValue[B] := R(A)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_SETTABLE,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A)[RK(B)] := RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_NEWTABLE,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := {} (size = B,C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_SELF,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A+1) := R(B); R(A) := R(B)[RK(C)]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_ADD,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) + RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_SUB,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) - RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_MUL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) * RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_MOD,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) % RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_POW,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) ^ RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_DIV,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) / RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_IDIV,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) // RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_BAND,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) &amp; RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_BOR,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) | RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_BXOR,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) ~ RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_SHL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) &lt;&lt; RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_SHR,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := RK(B) &gt;&gt; RK(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_UNM,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A) := -R(B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_BNOT,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A) := ~R(B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_NOT,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A) := not R(B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LEN,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A) := length of R(B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_CONCAT,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A) := R(B).. ... ..R(C)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_JMP,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A sBx&nbsp; &nbsp; &nbsp; &nbsp; pc+=sBx; if (A) close all upvalues &gt;= R(A - 1)&nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_EQ,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; if ((RK(B) == RK(C)) ~= A) then pc++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LT,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; if ((RK(B) &lt;&nbsp; RK(C)) ~= A) then pc++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_LE,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; if ((RK(B) &lt;= RK(C)) ~= A) then pc++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_TEST,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A C&nbsp; &nbsp; &nbsp; &nbsp; if not (R(A) &lt;=&gt; C) then pc++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_TESTSET,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; if (R(B) &lt;=&gt; C) then R(A) := R(B) else pc++&nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_CALL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A), ... ,R(A+C-2) := R(A)(R(A+1), ... ,R(A+B-1)) */<br/></li>
<li></span>OP_TAILCALL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; return R(A)(R(A+1), ... ,R(A+B-1))&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_RETURN,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; return R(A), ... ,R(A+B-2)&nbsp; &nbsp; &nbsp; &nbsp; (see note)&nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_FORLOOP,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A sBx&nbsp; &nbsp; &nbsp; &nbsp; R(A)+=R(A+2);<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if R(A) &lt;?= R(A+1) then { pc+=sBx; R(A+3)=R(A) }*/<br/></li>
<li></span>OP_FORPREP,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A sBx&nbsp; &nbsp; &nbsp; &nbsp; R(A)-=R(A+2); pc+=sBx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_TFORCALL,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A C&nbsp; &nbsp; &nbsp; &nbsp; R(A+3), ... ,R(A+2+C) := R(A)(R(A+1), R(A+2));&nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span>OP_TFORLOOP,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A sBx&nbsp; &nbsp; &nbsp; &nbsp; if R(A+1) ~= nil then { R(A)=R(A+1); pc += sBx }*/<br/></li>
<li></span><br/></li>
<li>OP_SETLIST,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B C&nbsp; &nbsp; &nbsp; &nbsp; R(A)[(C-1)*FPF+i] := R(A+i), 1 &lt;= i &lt;= B&nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_CLOSURE,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A Bx&nbsp; &nbsp; &nbsp; &nbsp; R(A) := closure(KPROTO[Bx])&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_VARARG,<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; A B&nbsp; &nbsp; &nbsp; &nbsp; R(A), R(A+1), ..., R(A+B-2) = vararg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><br/></li>
<li>OP_EXTRAARG<span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; Ax&nbsp; &nbsp; &nbsp; &nbsp; extra (larger) argument for previous opcode&nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li><a id="L232">&#x200c;</a></span>} <span class="linkable">OpCode</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L235">&#x200c;</a><span class="PreProc">#define <span class="linkable">NUM_OPCODES</span>&nbsp; &nbsp; &nbsp; &nbsp; (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">int</span><span class="PreProc">, OP_EXTRAARG) + </span><span class="Constant">1</span><span class="PreProc">)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*===========================================================================<br/></li>
<li></span><span class="Comment">&nbsp; Notes:<br/></li>
<li></span><span class="Comment">&nbsp; (*) In OP_CALL, if (B == 0) then B = top. If (C == 0), then 'top' is<br/></li>
<li></span><span class="Comment">&nbsp; set to last_result+1, so <a href="llex.c.html#L31" title="llex.c:31">next</a> open instruction (OP_CALL, OP_RETURN,<br/></li>
<li></span><span class="Comment">&nbsp; OP_SETLIST) may use 'top'.<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; (*) In OP_VARARG, if (B == 0) then use actual number of varargs and<br/></li>
<li></span><span class="Comment">&nbsp; set top (like in OP_CALL with C == 0).<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; (*) In OP_RETURN, if (B == 0) then return up to 'top'.<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; (*) In OP_SETLIST, if (B == 0) then B = 'top'; if (C == 0) then <a href="llex.c.html#L31" title="llex.c:31">next</a><br/></li>
<li></span><span class="Comment">&nbsp; 'instruction' is EXTRAARG(real C).<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; (*) In OP_LOADKX, the <a href="llex.c.html#L31" title="llex.c:31">next</a> 'instruction' is always EXTRAARG.<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; (*) For comparisons, A specifies what condition the test should accept<br/></li>
<li></span><span class="Comment">&nbsp; (true or false).<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; (*) All 'skips' (pc++) assume that <a href="llex.c.html#L31" title="llex.c:31">next</a> instruction is a jump.<br/></li>
<li></span><br/></li>
<li><span class="Comment">===========================================================================*/<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** masks for instruction properties. The format is:<br/></li>
<li></span><span class="Comment">** bits 0-1: op mode<br/></li>
<li></span><span class="Comment">** bits 2-3: C arg mode<br/></li>
<li></span><span class="Comment">** bits 4-5: B arg mode<br/></li>
<li></span><span class="Comment">** bit 6: instruction set register A<br/></li>
<li></span><span class="Comment">** bit 7: operator is a test (<a href="llex.c.html#L31" title="llex.c:31">next</a> instruction must be a jump)<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><a id="L272">&#x200c;</a><span class="Type">enum</span> <span class="linkable">OpArgMask</span> {<br/></li>
<li>&nbsp; OpArgN,&nbsp; <span class="Comment">/* argument is not used */<br/></li>
<li></span>&nbsp; OpArgU,&nbsp; <span class="Comment">/* argument is used */<br/></li>
<li></span>&nbsp; OpArgR,&nbsp; <span class="Comment">/* argument is a register or a jump offset */<br/></li>
<li></span>&nbsp; OpArgK&nbsp;&nbsp; <span class="Comment">/* argument is a constant or register/constant */<br/></li>
<li></span>};<br/></li>
<li><br/></li>
<li><a id="L279">&#x200c;</a><a href="luaconf.h.html#L260" title="luaconf.h:260">LUAI_DDEC</a> <span class="Type">const</span> <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> <span class="linkable">luaP_opmodes</span>[<a href="#L235" title="lopcodes.h:235">NUM_OPCODES</a>];<br/></li>
<li><br/></li>
<li><a id="L281">&#x200c;</a><span class="PreProc">#define <span class="linkable">getOpMode</span>(m)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">enum</span><span class="PreProc"> <a href="#L32" title="lopcodes.h:32">OpMode</a>, <a href="lopcodes.c.html#L74" title="lopcodes.c:74">luaP_opmodes</a>[m] &amp; </span><span class="Constant">3</span><span class="PreProc">))<br/></li>
<li><a id="L282">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">getBMode</span>(m)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">enum</span><span class="PreProc"> <a href="#L272" title="lopcodes.h:272">OpArgMask</a>, (<a href="lopcodes.c.html#L74" title="lopcodes.c:74">luaP_opmodes</a>[m] &gt;&gt; </span><span class="Constant">4</span><span class="PreProc">) &amp; </span><span class="Constant">3</span><span class="PreProc">))<br/></li>
<li><a id="L283">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">getCMode</span>(m)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">enum</span><span class="PreProc"> <a href="#L272" title="lopcodes.h:272">OpArgMask</a>, (<a href="lopcodes.c.html#L74" title="lopcodes.c:74">luaP_opmodes</a>[m] &gt;&gt; </span><span class="Constant">2</span><span class="PreProc">) &amp; </span><span class="Constant">3</span><span class="PreProc">))<br/></li>
<li><a id="L284">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">testAMode</span>(m)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="lopcodes.c.html#L74" title="lopcodes.c:74">luaP_opmodes</a>[m] &amp; (</span><span class="Constant">1</span><span class="PreProc"> &lt;&lt; </span><span class="Constant">6</span><span class="PreProc">))<br/></li>
<li><a id="L285">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">testTMode</span>(m)&nbsp; &nbsp; &nbsp; &nbsp; (<a href="lopcodes.c.html#L74" title="lopcodes.c:74">luaP_opmodes</a>[m] &amp; (</span><span class="Constant">1</span><span class="PreProc"> &lt;&lt; </span><span class="Constant">7</span><span class="PreProc">))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L288">&#x200c;</a><a href="luaconf.h.html#L260" title="luaconf.h:260">LUAI_DDEC</a> <span class="Type">const</span> <span class="Type">char</span> *<span class="Type">const</span> <span class="linkable">luaP_opnames</span>[<a href="#L235" title="lopcodes.h:235">NUM_OPCODES</a>+<span class="Constant">1</span>];&nbsp; <span class="Comment">/* opcode names */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* number of list items to accumulate before a SETLIST instruction */<br/></li>
<li><a id="L292">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">LFIELDS_PER_FLUSH</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">50<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
</ol></span></code>
 </body>
</html>
