<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>lstate.h - src</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
  <h3>lstate.h - src</h3>
   <a href="../index.html"> Table of Contents </a>
 <h4>Data types defined</h4>
 <ul>
<li><a href="#L65">CallInfo</a></li>
<li><a href="#L83">CallInfo</a></li>
<li><a href="#L181">GCUnion</a></li>
<li><a href="#L108">global_State</a></li>
<li><a href="#L143">global_State</a></li>
<li><a href="#L149">lua_State</a></li>
<li><a href="#L49">stringtable</a></li>
<li><a href="#L53">stringtable</a></li>
</ul>
 <h4>Macros defined</h4>
 <ul>
<li><a href="#L41">BASIC_STACK_SIZE</a></li>
<li><a href="#L91">CIST_HOOKED</a></li>
<li><a href="#L96">CIST_HOOKYIELD</a></li>
<li><a href="#L90">CIST_LUA</a></li>
<li><a href="#L89">CIST_OAH</a></li>
<li><a href="#L92">CIST_REENTRY</a></li>
<li><a href="#L95">CIST_TAIL</a></li>
<li><a href="#L94">CIST_YPCALL</a></li>
<li><a href="#L38">EXTRA_STACK</a></li>
<li><a href="#L175">G</a></li>
<li><a href="#L46">KGC_EMERGENCY</a></li>
<li><a href="#L45">KGC_NORMAL</a></li>
<li><a href="#L192">cast_u</a></li>
<li><a href="#L199">gco2ccl</a></li>
<li><a href="#L200">gco2cl</a></li>
<li><a href="#L198">gco2lcl</a></li>
<li><a href="#L203">gco2p</a></li>
<li><a href="#L202">gco2t</a></li>
<li><a href="#L204">gco2th</a></li>
<li><a href="#L195">gco2ts</a></li>
<li><a href="#L197">gco2u</a></li>
<li><a href="#L102">getoah</a></li>
<li><a href="#L213">gettotalbytes</a></li>
<li><a href="#L98">isLua</a></li>
<li><a href="#L8">lstate_h</a></li>
<li><a href="#L208">obj2gco</a></li>
<li><a href="#L101">setoah</a></li>
</ul>
 <h4>Source code</h4>

  <code><ol><li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** $Id: lstate.h,v 2.119 2014/10/30 18:53:28 roberto Exp $<br/></li>
<li></span><span class="Comment">** Global State<br/></li>
<li></span><span class="Comment">** See Copyright Notice in lua.h<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifndef <a href="#L8" title="lstate.h:8">lstate_h</a><br/></li>
<li><a id="L8">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">lstate_h</span><br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lua.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;lobject.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;ltm.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;lzio.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><br/></li>
<li><span class="Comment">** Some notes about garbage-collected objects: All objects in Lua must<br/></li>
<li></span><span class="Comment">** be kept somehow accessible until being freed, so all objects always<br/></li>
<li></span><span class="Comment">** belong to one (and only one) of these lists, using <a href="lparser.c.html#L696" title="lparser.c:696">field</a> '<a href="llex.c.html#L31" title="llex.c:31">next</a>' of<br/></li>
<li></span><span class="Comment">** the '<a href="lobject.h.html#L81" title="lobject.h:81">CommonHeader</a>' for the link:<br/></li>
<li></span><span class="Comment">**<br/></li>
<li></span><span class="Comment">** 'allgc': all objects not marked for finalization;<br/></li>
<li></span><span class="Comment">** 'finobj': all objects marked for finalization;<br/></li>
<li></span><span class="Comment">** 'tobefnz': all objects ready to be finalized;<br/></li>
<li></span><span class="Comment">** 'fixedgc': all objects that are not to be collected (currently<br/></li>
<li></span><span class="Comment">** only small strings, such as reserved words).<br/></li>
<li></span><br/></li>
<li><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Type">struct</span> <a href="ldo.c.html#L84" title="ldo.c:84">lua_longjmp</a>;&nbsp; <span class="Comment">/* defined in ldo.c */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* extra stack space to handle TM calls and some other extras */<br/></li>
<li><a id="L38">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">EXTRA_STACK</span>&nbsp;&nbsp; </span><span class="Constant">5<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L41">&#x200c;</a><span class="PreProc">#define <span class="linkable">BASIC_STACK_SIZE</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">2</span><span class="PreProc">*<a href="lua.h.html#L77" title="lua.h:77">LUA_MINSTACK</a>)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* kinds of Garbage Collection */<br/></li>
<li><a id="L45">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">KGC_NORMAL</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">0<br/></li>
<li><a id="L46">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">KGC_EMERGENCY</span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">1</span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* gc was forced by an allocation failure */<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L49">&#x200c;</a><span class="Type">typedef</span> <span class="Type">struct</span> <span class="linkable">stringtable</span> {<br/></li>
<li>&nbsp; <a href="lobject.h.html#L303" title="lobject.h:303">TString</a> **hash;<br/></li>
<li>&nbsp; <span class="Type">int</span> nuse;&nbsp; <span class="Comment">/* number of elements */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> size;<br/></li>
<li><a id="L53">&#x200c;</a>} <span class="linkable">stringtable</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** Information about a call.<br/></li>
<li></span><span class="Comment">** When a thread yields, 'func' is adjusted to pretend that the<br/></li>
<li></span><span class="Comment">** top function has only the yielded values in its stack; in that<br/></li>
<li></span><span class="Comment">** case, the actual 'func' value is saved in <a href="lparser.c.html#L696" title="lparser.c:696">field</a> 'extra'.<br/></li>
<li></span><span class="Comment">** When a function calls another with a continuation, 'extra' keeps<br/></li>
<li></span><span class="Comment">** the function index so that, in case of errors, the continuation<br/></li>
<li></span><span class="Comment">** function can be called with the correct top.<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L65">&#x200c;</a></span><span class="Type">typedef</span> <span class="Type">struct</span> <span class="linkable">CallInfo</span> {<br/></li>
<li>&nbsp; <a href="lobject.h.html#L294" title="lobject.h:294">StkId</a> func;&nbsp; <span class="Comment">/* function index in the stack */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L294" title="lobject.h:294">StkId</a>&nbsp; &nbsp; &nbsp; &nbsp; top;&nbsp; <span class="Comment">/* top for this function */<br/></li>
<li></span>&nbsp; <span class="Type">struct</span> <a href="#L65" title="lstate.h:65">CallInfo</a> *previous, *<a href="llex.c.html#L31" title="llex.c:31">next</a>;&nbsp; <span class="Comment">/* dynamic call link */<br/></li>
<li></span>&nbsp; <span class="Type">union</span> {<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> {&nbsp; <span class="Comment">/* only for Lua functions */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="lobject.h.html#L294" title="lobject.h:294">StkId</a> base;&nbsp; <span class="Comment">/* base for this function */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Type">const</span> <a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a> *savedpc;<br/></li>
<li>&nbsp; &nbsp; } l;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> {&nbsp; <span class="Comment">/* only for C functions */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="lua.h.html#L108" title="lua.h:108">lua_KFunction</a> k;&nbsp; <span class="Comment">/* continuation in case of yields */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Type">ptrdiff_t</span> old_errfunc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="lua.h.html#L97" title="lua.h:97">lua_KContext</a> ctx;&nbsp; <span class="Comment">/* context info. in case of yields */<br/></li>
<li></span>&nbsp; &nbsp; } c;<br/></li>
<li>&nbsp; } u;<br/></li>
<li>&nbsp; <span class="Type">ptrdiff_t</span> extra;<br/></li>
<li>&nbsp; <span class="Type">short</span> nresults;&nbsp; <span class="Comment">/* expected number of results from this function */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> callstatus;<br/></li>
<li><a id="L83">&#x200c;</a>} <span class="linkable">CallInfo</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** Bits in <a href="#L65" title="lstate.h:65">CallInfo</a> status<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L89">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_OAH</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">0</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* original value of 'allowhook' */<br/></li>
<li><a id="L90">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_LUA</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">1</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* call is running a Lua function */<br/></li>
<li><a id="L91">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_HOOKED</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">2</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* call is running a debug hook */<br/></li>
<li><a id="L92">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_REENTRY</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">3</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* call is running on same invocation of<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="lvm.c.html#L650" title="lvm.c:650">luaV_execute</a> of previous call */<br/></li>
<li><a id="L94">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_YPCALL</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">4</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* call is a yieldable protected call */<br/></li>
<li><a id="L95">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_TAIL</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">5</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* call was tail called */<br/></li>
<li><a id="L96">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">CIST_HOOKYIELD</span>&nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="Constant">1</span><span class="PreProc">&lt;&lt;</span><span class="Constant">6</span><span class="PreProc">)&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">/* last hook called yielded */<br/></li>
<li></span><br/></li>
<li><a id="L98">&#x200c;</a><span class="PreProc">#define <span class="linkable">isLua</span>(ci)&nbsp; &nbsp; &nbsp; &nbsp; ((ci)-&gt;callstatus &amp; <a href="#L90" title="lstate.h:90">CIST_LUA</a>)<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* assume that <a href="#L89" title="lstate.h:89">CIST_OAH</a> has offset 0 and that 'v' is strictly 0/1 */<br/></li>
<li><a id="L101">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">setoah</span>(st,v)&nbsp; &nbsp; &nbsp; &nbsp; ((st) = ((st) &amp; ~<a href="#L89" title="lstate.h:89">CIST_OAH</a>) | (v))<br/></li>
<li><a id="L102">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">getoah</span>(st)&nbsp; &nbsp; &nbsp; &nbsp; ((st) &amp; <a href="#L89" title="lstate.h:89">CIST_OAH</a>)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** 'global state', shared by all threads of this state<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L108">&#x200c;</a></span><span class="Type">typedef</span> <span class="Type">struct</span> <span class="linkable">global_State</span> {<br/></li>
<li>&nbsp; <a href="lua.h.html#L122" title="lua.h:122">lua_Alloc</a> frealloc;&nbsp; <span class="Comment">/* function to reallocate memory */<br/></li>
<li></span>&nbsp; <span class="Type">void</span> *ud;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">/* auxiliary data to 'frealloc' */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L23" title="llimits.h:23">lu_mem</a> totalbytes;&nbsp; <span class="Comment">/* number of bytes currently allocated - GCdebt */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L24" title="llimits.h:24">l_mem</a> GCdebt;&nbsp; <span class="Comment">/* bytes allocated not yet compensated by the collector */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L23" title="llimits.h:23">lu_mem</a> GCmemtrav;&nbsp; <span class="Comment">/* memory traversed by the GC */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L23" title="llimits.h:23">lu_mem</a> GCestimate;&nbsp; <span class="Comment">/* an estimate of the non-garbage memory in use */<br/></li>
<li></span>&nbsp; <a href="#L49" title="lstate.h:49">stringtable</a> strt;&nbsp; <span class="Comment">/* hash table for strings */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L108" title="lobject.h:108">TValue</a> l_registry;<br/></li>
<li>&nbsp; <span class="Type">unsigned</span> <span class="Type">int</span> seed;&nbsp; <span class="Comment">/* randomized seed for hashes */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> currentwhite;<br/></li>
<li>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> gcstate;&nbsp; <span class="Comment">/* state of garbage collector */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> gckind;&nbsp; <span class="Comment">/* kind of GC running */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> gcrunning;&nbsp; <span class="Comment">/* true if GC is running */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *allgc;&nbsp; <span class="Comment">/* list of all collectable objects */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> **sweepgc;&nbsp; <span class="Comment">/* current position of sweep in list */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *finobj;&nbsp; <span class="Comment">/* list of collectable objects with finalizers */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *gray;&nbsp; <span class="Comment">/* list of gray objects */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *grayagain;&nbsp; <span class="Comment">/* list of objects to be traversed atomically */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *weak;&nbsp; <span class="Comment">/* list of tables with weak values */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *ephemeron;&nbsp; <span class="Comment">/* list of ephemeron tables (weak keys) */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *allweak;&nbsp; <span class="Comment">/* list of all-weak tables */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *tobefnz;&nbsp; <span class="Comment">/* list of userdata to be GC */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *fixedgc;&nbsp; <span class="Comment">/* list of objects not to be collected */<br/></li>
<li></span>&nbsp; <span class="Type">struct</span> <a href="#L149" title="lstate.h:149">lua_State</a> *twups;&nbsp; <span class="Comment">/* list of threads with open upvalues */<br/></li>
<li></span>&nbsp; <a href="lzio.h.html#L23" title="lzio.h:23">Mbuffer</a> buff;&nbsp; <span class="Comment">/* temporary buffer for string concatenation */<br/></li>
<li></span>&nbsp; <span class="Type">unsigned</span> <span class="Type">int</span> gcfinnum;&nbsp; <span class="Comment">/* number of finalizers to call in each GC step */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> gcpause;&nbsp; <span class="Comment">/* size of pause between successive GCs */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> gcstepmul;&nbsp; <span class="Comment">/* GC 'granularity' */<br/></li>
<li></span>&nbsp; <a href="lua.h.html#L103" title="lua.h:103">lua_CFunction</a> <a href="lauxlib.c.html#L948" title="lauxlib.c:948">panic</a>;&nbsp; <span class="Comment">/* to be called in unprotected errors */<br/></li>
<li></span>&nbsp; <span class="Type">struct</span> <a href="#L149" title="lstate.h:149">lua_State</a> *mainthread;<br/></li>
<li>&nbsp; <span class="Type">const</span> <a href="lua.h.html#L87" title="lua.h:87">lua_Number</a> *version;&nbsp; <span class="Comment">/* pointer to version number */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L303" title="lobject.h:303">TString</a> *memerrmsg;&nbsp; <span class="Comment">/* memory-<a href="lundump.c.html#L40" title="lundump.c:40">error</a> message */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L303" title="lobject.h:303">TString</a> *tmname[TM_N];&nbsp; <span class="Comment">/* array with tag-method names */<br/></li>
<li></span>&nbsp; <span class="Type">struct</span> <a href="lobject.h.html#L488" title="lobject.h:488">Table</a> *mt[<a href="lua.h.html#L72" title="lua.h:72">LUA_NUMTAGS</a>];&nbsp; <span class="Comment">/* metatables for basic types */<br/></li>
<li><a id="L143">&#x200c;</a></span>} <span class="linkable">global_State</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** 'per thread' state<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L149">&#x200c;</a></span><span class="Type">struct</span> <span class="linkable">lua_State</span> {<br/></li>
<li>&nbsp; <a href="lobject.h.html#L81" title="lobject.h:81">CommonHeader</a>;<br/></li>
<li>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> status;<br/></li>
<li>&nbsp; <a href="lobject.h.html#L294" title="lobject.h:294">StkId</a> top;&nbsp; <span class="Comment">/* first free slot in the stack */<br/></li>
<li></span>&nbsp; <a href="#L108" title="lstate.h:108">global_State</a> *l_G;<br/></li>
<li>&nbsp; <a href="#L65" title="lstate.h:65">CallInfo</a> *ci;&nbsp; <span class="Comment">/* call info for current function */<br/></li>
<li></span>&nbsp; <span class="Type">const</span> <a href="llimits.h.html#L164" title="llimits.h:164">Instruction</a> *oldpc;&nbsp; <span class="Comment">/* last pc traced */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L294" title="lobject.h:294">StkId</a> stack_last;&nbsp; <span class="Comment">/* last free slot in the stack */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L294" title="lobject.h:294">StkId</a> stack;&nbsp; <span class="Comment">/* stack base */<br/></li>
<li></span>&nbsp; <a href="lfunc.h.html#L28" title="lfunc.h:28">UpVal</a> *openupval;&nbsp; <span class="Comment">/* list of open upvalues in this stack */<br/></li>
<li></span>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> *gclist;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="#L149" title="lstate.h:149">lua_State</a> *twups;&nbsp; <span class="Comment">/* list of threads with open upvalues */<br/></li>
<li></span>&nbsp; <span class="Type">struct</span> <a href="ldo.c.html#L84" title="ldo.c:84">lua_longjmp</a> *errorJmp;&nbsp; <span class="Comment">/* current <a href="lundump.c.html#L40" title="lundump.c:40">error</a> <a href="ldo.c.html#L497" title="ldo.c:497">recover</a> point */<br/></li>
<li></span>&nbsp; <a href="#L65" title="lstate.h:65">CallInfo</a> base_ci;&nbsp; <span class="Comment">/* <a href="#L65" title="lstate.h:65">CallInfo</a> for first level (C calling Lua) */<br/></li>
<li></span>&nbsp; <a href="lua.h.html#L420" title="lua.h:420">lua_Hook</a> hook;<br/></li>
<li>&nbsp; <span class="Type">ptrdiff_t</span> errfunc;&nbsp; <span class="Comment">/* current <a href="lundump.c.html#L40" title="lundump.c:40">error</a> handling function (stack index) */<br/></li>
<li></span>&nbsp; <span class="Type">int</span> stacksize;<br/></li>
<li>&nbsp; <span class="Type">int</span> basehookcount;<br/></li>
<li>&nbsp; <span class="Type">int</span> hookcount;<br/></li>
<li>&nbsp; <span class="Type">unsigned</span> <span class="Type">short</span> nny;&nbsp; <span class="Comment">/* number of non-yieldable calls in stack */<br/></li>
<li></span>&nbsp; <span class="Type">unsigned</span> <span class="Type">short</span> nCcalls;&nbsp; <span class="Comment">/* number of nested C calls */<br/></li>
<li></span>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> hookmask;<br/></li>
<li>&nbsp; <a href="llimits.h.html#L35" title="llimits.h:35">lu_byte</a> allowhook;<br/></li>
<li>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L175">&#x200c;</a><span class="PreProc">#define <span class="linkable">G</span>(L)&nbsp; &nbsp; &nbsp; &nbsp; (L-&gt;l_G)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment">** Union of all collectable objects (only for conversions)<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li><a id="L181">&#x200c;</a></span><span class="Type">union</span> <span class="linkable">GCUnion</span> {<br/></li>
<li>&nbsp; <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> gc;&nbsp; <span class="Comment">/* common header */<br/></li>
<li></span>&nbsp; <span class="Type">struct</span> <a href="lobject.h.html#L303" title="lobject.h:303">TString</a> ts;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="lobject.h.html#L337" title="lobject.h:337">Udata</a> u;<br/></li>
<li>&nbsp; <span class="Type">union</span> <a href="lobject.h.html#L451" title="lobject.h:451">Closure</a> cl;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="lobject.h.html#L488" title="lobject.h:488">Table</a> h;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="lobject.h.html#L398" title="lobject.h:398">Proto</a> p;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="#L149" title="lstate.h:149">lua_State</a> th;&nbsp; <span class="Comment">/* thread */<br/></li>
<li></span>};<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L192">&#x200c;</a><span class="PreProc">#define <span class="linkable">cast_u</span>(o)&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L107" title="llimits.h:107">cast</a>(</span><span class="Type">union</span><span class="PreProc"> <a href="#L181" title="lstate.h:181">GCUnion</a> *, (o))<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* macros to convert a <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> into a specific value */<br/></li>
<li><a id="L195">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2ts</span>(o)&nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>(<a href="lobject.h.html#L122" title="lobject.h:122">novariant</a>((o)-&gt;tt) == <a href="lua.h.html#L66" title="lua.h:66">LUA_TSTRING</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;ts))<br/></li>
<li><a id="L197">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2u</span>(o)&nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>((o)-&gt;tt == <a href="lua.h.html#L69" title="lua.h:69">LUA_TUSERDATA</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;u))<br/></li>
<li><a id="L198">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2lcl</span>(o)&nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>((o)-&gt;tt == <a href="lobject.h.html#L49" title="lobject.h:49">LUA_TLCL</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;cl.l))<br/></li>
<li><a id="L199">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2ccl</span>(o)&nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>((o)-&gt;tt == <a href="lobject.h.html#L51" title="lobject.h:51">LUA_TCCL</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;cl.c))<br/></li>
<li><a id="L200">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2cl</span>(o)&nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>(<a href="lobject.h.html#L122" title="lobject.h:122">novariant</a>((o)-&gt;tt) == <a href="lua.h.html#L68" title="lua.h:68">LUA_TFUNCTION</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;cl))<br/></li>
<li><a id="L202">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2t</span>(o)&nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>((o)-&gt;tt == <a href="lua.h.html#L67" title="lua.h:67">LUA_TTABLE</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;h))<br/></li>
<li><a id="L203">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2p</span>(o)&nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>((o)-&gt;tt == <a href="lobject.h.html#L22" title="lobject.h:22">LUA_TPROTO</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;p))<br/></li>
<li><a id="L204">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gco2th</span>(o)&nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>((o)-&gt;tt == <a href="lua.h.html#L70" title="lua.h:70">LUA_TTHREAD</a>, &amp;((<a href="#L192" title="lstate.h:192">cast_u</a>(o))-&gt;th))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* macro to convert a Lua object into a <a href="lobject.h.html#L87" title="lobject.h:87">GCObject</a> */<br/></li>
<li><a id="L208">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">obj2gco</span>(v) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; <a href="llimits.h.html#L79" title="llimits.h:79">check_exp</a>(<a href="lobject.h.html#L122" title="lobject.h:122">novariant</a>((v)-&gt;tt) &lt; <a href="lobject.h.html#L23" title="lobject.h:23">LUA_TDEADKEY</a>, (&amp;(<a href="#L192" title="lstate.h:192">cast_u</a>(v)-&gt;gc)))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* actual number of total bytes allocated */<br/></li>
<li><a id="L213">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">gettotalbytes</span>(g)&nbsp; &nbsp; &nbsp; &nbsp; ((g)-&gt;totalbytes + (g)-&gt;GCdebt)<br/></li>
<li></span><br/></li>
<li><a href="luaconf.h.html#L255" title="luaconf.h:255">LUAI_FUNC</a> <span class="Type">void</span> <a href="lstate.c.html#L101" title="lstate.c:101">luaE_setdebt</a> (<a href="#L108" title="lstate.h:108">global_State</a> *g, <a href="llimits.h.html#L24" title="llimits.h:24">l_mem</a> debt);<br/></li>
<li><a href="luaconf.h.html#L255" title="luaconf.h:255">LUAI_FUNC</a> <span class="Type">void</span> <a href="lstate.c.html#L283" title="lstate.c:283">luaE_freethread</a> (<a href="#L149" title="lstate.h:149">lua_State</a> *L, <a href="#L149" title="lstate.h:149">lua_State</a> *L1);<br/></li>
<li><a href="luaconf.h.html#L255" title="luaconf.h:255">LUAI_FUNC</a> <a href="#L65" title="lstate.h:65">CallInfo</a> *<a href="lstate.c.html#L107" title="lstate.c:107">luaE_extendCI</a> (<a href="#L149" title="lstate.h:149">lua_State</a> *L);<br/></li>
<li><a href="luaconf.h.html#L255" title="luaconf.h:255">LUAI_FUNC</a> <span class="Type">void</span> <a href="lstate.c.html#L120" title="lstate.c:120">luaE_freeCI</a> (<a href="#L149" title="lstate.h:149">lua_State</a> *L);<br/></li>
<li><a href="luaconf.h.html#L255" title="luaconf.h:255">LUAI_FUNC</a> <span class="Type">void</span> <a href="lstate.c.html#L134" title="lstate.c:134">luaE_shrinkCI</a> (<a href="#L149" title="lstate.h:149">lua_State</a> *L);<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
</ol></code>
 </body>
</html>
